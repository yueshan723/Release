<files codepage='65001' xmlns:dt='urn:schemas-microsoft-com:datatypes'>
	<file name='zb_system\function\lib\zblogphp.php' crc32='49CBE60'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoqDQogKiB6YnDlhajlsYDmk43kvZznsbsuIA0KICovDQpjbGFzcyBaQmxvZ1BIUA0Kew0KICAgIHByaXZhdGUgc3RhdGljICRfemJwID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDniYjmnKzlj7cNCiAgICAgKi8NCiAgICBwdWJsaWMgJHZlcnNpb24gPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgRGF0YWJhc2VfX0ludGVyZmFjZSDmlbDmja7lupMNCiAgICAgKi8NCiAgICBwdWJsaWMgJGRiID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOmFjee9rumAiemhuQ0KICAgICAqLw0KICAgIHB1YmxpYyAkb3B0aW9uID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5IOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBqc29u57G75Z6LIOivreiogA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3MgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg6K+t6KiA5YyFbGlzdA0KICAgICAqLw0KICAgIHB1YmxpYyAkbGFuZ3BhY2tsaXN0ID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDot6/lvoQNCiAgICAgKi8NCiAgICBwdWJsaWMgJHBhdGggPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOWfn+WQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkaG9zdCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgY29va2ll5L2c55So5Z+fDQogICAgICovDQogICAgcHVibGljICRjb29raWVzcGF0aCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcgZ3VpZA0KICAgICAqLw0KICAgIHB1YmxpYyAkZ3VpZCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg5b2T5YmN6ZO+5o6lDQogICAgICovDQogICAgcHVibGljICRjdXJyZW50dXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDlvZPliY3pk77mjqUNCiAgICAgKi8NCiAgICBwdWJsaWMgJGZ1bGxjdXJyZW50dXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDnlKjmiLfnm67lvZUNCiAgICAgKi8NCiAgICBwdWJsaWMgJHVzZXJzZGlyID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZyDpqozor4HnoIHlnLDlnYANCiAgICAgKi8NCiAgICBwdWJsaWMgJHZlcmlmeUNvZGVVcmwgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOmqjOivgeeggeWcsOWdgO+8iOaLvOWGmemUmeivr++8iQ0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgJHZhbGlkY29kZXVybCA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgJGZlZWR1cmwgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRzZWFyY2h1cmwgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHVibGljICRhamF4dXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyAkeG1scnBjdXJsID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIE1lbWJlcltdIOeUqOaIt+aVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkbWVtYmVycyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXJbXSDnlKjmiLfmlbDnu4TvvIjku6XnlKjmiLflkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1lbWJlcnNieW5hbWUgPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIEB2YXIgQ2F0ZWdvcnlbXSDliIbnsbvmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhdGVnb3J5cyA9IGFycmF5KCk7DQogICAgcHVibGljICRjYXRlZ29yaWVzID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIENhdGVnb3J5W10g5YiG57G75pWw57uE77yI5bey5o6S5bqP77yJDQogICAgICovDQogICAgcHVibGljICRjYXRlZ29yeXNieW9yZGVyID0gYXJyYXkoKTsNCiAgICBwdWJsaWMgJGNhdGVnb3JpZXNieW9yZGVyID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIE1vZHVsZVtdIOaooeWdl+aVsOe7hA0KICAgICAqLw0KICAgIHB1YmxpYyAkbW9kdWxlcyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBNb2R1bGVbXSDmqKHlnZfmlbDnu4TvvIjku6Xmlofku7blkI3kuLrplK7vvIkNCiAgICAgKi8NCiAgICBwdWJsaWMgJG1vZHVsZXNieWZpbGVuYW1lID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbmZpZ1tdIOmFjee9rumAiemhuQ0KICAgICAqLw0KICAgIHB1YmxpYyAkY29uZmlncyA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICogQHZhciBUYWdbXSDmoIfnrb7mlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhZ3MgPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIEB2YXIgVGFnW10g5qCH562+5pWw57uE77yI5Lul5qCH562+5ZCN5Li66ZSu77yJDQogICAgICovDQogICAgcHVibGljICR0YWdzYnluYW1lID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbW1lbnRbXSDor4TorrrmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNvbW1lbnRzID0gYXJyYXkoKTsNCiAgICAvKioNCiAgICAgKiBAdmFyIFBvc3RbXSDmlofnq6DliJfooajmlbDnu4QNCiAgICAgKi8NCiAgICBwdWJsaWMgJHBvc3RzID0gYXJyYXkoKTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjemhtemdouagh+mimA0KICAgICAqLw0KICAgIHB1YmxpYyAkdGl0bGUgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOe9keermeWQjQ0KICAgICAqLw0KICAgIHB1YmxpYyAkbmFtZSA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBzdHJpbmcg572R56uZ5a2Q5qCH6aKYDQogICAgICovDQogICAgcHVibGljICRzdWJuYW1lID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopgNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5KCkg5b2T5YmN5Li76aKY54mI5pys5L+h5oGvDQogICAgICovDQogICAgcHVibGljICR0aGVtZWluZm8gPSBhcnJheSgpOw0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nIOW9k+WJjeS4u+mimOmjjuagvA0KICAgICAqLw0KICAgIHB1YmxpYyAkc3R5bGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBNZW1iZXIg5b2T5YmN55So5oi3DQogICAgICovDQogICAgcHVibGljICR1c2VyID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIENvbmZpZyDnvJPlrZgNCiAgICAgKi8NCiAgICBwdWJsaWMgJGNhY2hlID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmlbDmja7ooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRhYmxlID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBAdmFyIGFycmF5fG51bGwg5pWw5o2u6KGo5L+h5oGvDQogICAgICovDQogICAgcHVibGljICRkYXRhaW5mbyA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBhcnJheXxudWxsIOexu+Wei+W6j+WIlw0KICAgICAqLw0KICAgIHB1YmxpYyAkcG9zdHR5cGUgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXl8bnVsbCDmk43kvZzliJfooagNCiAgICAgKi8NCiAgICBwdWJsaWMgJGFjdGlvbnMgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgbWl4ZWR8bnVsbHxzdHJpbmcg5b2T5YmN5pON5L2cDQogICAgICovDQogICAgcHVibGljICRhY3Rpb24gPSBudWxsOw0KDQogICAgcHJpdmF0ZSAkaXNpbml0aWFsaXplZCA9IGZhbHNlOyAvL+aYr+WQpuWIneWni+WMluaIkOWKnw0KICAgIHByaXZhdGUgJGlzY29ubmVjdGVkID0gZmFsc2U7IC8v5piv5ZCm6L+e5o6l5oiQ5YqfDQogICAgcHJpdmF0ZSAkaXNsb2FkID0gZmFsc2U7IC8v5piv5ZCm6L295YWlDQogICAgcHJpdmF0ZSAkaXNzZXNzaW9uID0gZmFsc2U7IC8v5piv5ZCm5L2/55Soc2Vzc2lvbg0KICAgIHB1YmxpYyAkaXNtYW5hZ2UgPSBmYWxzZTsgLy/mmK/lkKbliqDovb3nrqHnkIbmqKHlvI8NCiAgICBwcml2YXRlICRpc0d6aXAgPSBmYWxzZTsgLy/mmK/lkKblvIDlkK9nemlwDQogICAgcHVibGljICRpc0h0dHBzID0gZmFsc2U7IC8v5piv5ZCmSFRUUFMNCiAgICBwdWJsaWMgJGlzY21kID0gZmFsc2U7IC8v5piv5ZCm5Yqg6L29Q01E5qih5byPDQogICAgcHVibGljICRpc2FqYXggPSBmYWxzZTsgLy/mmK/lkKbliqDovb1BSkFY5qih5byPDQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFRlbXBsYXRlIOW9k+WJjeaooeadvw0KICAgICAqLw0KICAgIHB1YmxpYyAkdGVtcGxhdGUgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgbnVsbCDnpL7kvJrljJbor4TorroNCiAgICAgKi8NCiAgICBwdWJsaWMgJHNvY2lhbGNvbW1lbnQgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIEB2YXIgbnVsbCDmqKHmnb/lpLTpg6gNCiAgICAgKi8NCiAgICBwdWJsaWMgJGhlYWRlciA9IG51bGw7DQogICAgLyoqDQogICAgICogQHZhciBudWxsIOaooeadv+WwvumDqA0KICAgICAqLw0KICAgIHB1YmxpYyAkZm9vdGVyID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkg5r+A5rS755qE5o+S5Lu25YiX6KGoDQogICAgICovDQogICAgcHVibGljICRhY3RpdmVkYXBwcyA9IGFycmF5KCk7DQogICAgcHVibGljICRhY3RpdmVhcHBzOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQg566h55CG6aG16Z2i5pi+56S65p2h5pWwDQogICAgICovDQogICAgcHVibGljICRtYW5hZ2Vjb3VudCA9IDUwOw0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOmhteeggeaYvuekuuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkcGFnZWJhcmNvdW50ID0gMTA7DQogICAgLyoqDQogICAgICogQHZhciBpbnQg5pCc57Si6L+U5Zue5p2h5pWwDQogICAgICovDQogICAgcHVibGljICRzZWFyY2hjb3VudCA9IDEwOw0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50IOaWh+eroOWIl+ihqOaYvuekuuadoeaVsA0KICAgICAqLw0KICAgIHB1YmxpYyAkZGlzcGxheWNvdW50ID0gMTA7DQogICAgLyoqDQogICAgICogQHZhciBpbnQg6K+E6K665pi+56S65pWw6YePDQogICAgICovDQogICAgcHVibGljICRjb21tZW50ZGlzcGxheWNvdW50ID0gMTA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludCDlvZPliY3lrp7kvovkuItDU1JGIFRva2Vu6L+H5pyf5pe26Ze077yI5bCP5pe277yJDQogICAgICovDQogICAgcHVibGljICRjc3JmRXhwaXJhdGlvbiA9IDE7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIEFwcCDlvZPliY3kuLvpopjnsbsNCiAgICAgKi8NCiAgICBwdWJsaWMgJHRoZW1lYXBwID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWUr+S4gOWunuS+iy4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gbnVsbHxaQmxvZ1BIUA0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gR2V0SW5zdGFuY2UoKQ0KICAgIHsNCiAgICAgICAgaWYgKCFpc3NldChzZWxmOjokX3picCkpIHsNCiAgICAgICAgICAgIGlmIChpc3NldCgkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ10pICYmIGlzc2V0KCRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX05BTUUnXSkgJiYgaXNfcmVhZGFibGUoWkJQX1BBVEggLiAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9GSUxFJ10pKSB7DQogICAgICAgICAgICAgICAgcmVxdWlyZSBaQlBfUEFUSCAuICRHTE9CQUxTWydvcHRpb24nXVsnWkNfR09EWkJQX0ZJTEUnXTsNCiAgICAgICAgICAgICAgICBzZWxmOjokX3picCA9IG5ldyAkR0xPQkFMU1snb3B0aW9uJ11bJ1pDX0dPRFpCUF9OQU1FJ10oKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgc2VsZjo6JF96YnAgPSBuZXcgc2VsZigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHNlbGY6OiRfemJwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIneWni+WMluaVsOaNruW6k+i/nuaOpS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUg5pWw5o2u6L+e5o6l57G75Z6LDQogICAgICoNCiAgICAgKiBAcmV0dXJuIERhdGFiYXNlX19JbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIEluaXRpYWxpemVEQigkdHlwZSkNCiAgICB7DQogICAgICAgIGlmICghdHJpbSgkdHlwZSkpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgICRuZXd0eXBlID0gJ0RhdGFiYXNlX18nIC4gdHJpbSgkdHlwZSk7DQoNCiAgICAgICAgcmV0dXJuIG5ldyAkbmV3dHlwZSgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaehOmAoOWHveaVsO+8jOWKoOi9veWfuuacrOmFjee9ruWIsCR6YnAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkNCiAgICB7DQogICAgICAgIGdsb2JhbCAkb3B0aW9uLCAkbGFuZywgJGxhbmdzLCAkYmxvZ3BhdGgsICRibG9naG9zdCwgJGNvb2tpZXNwYXRoLCAkdXNlcnNkaXIsICR0YWJsZSwNCiAgICAgICAgJGRhdGFpbmZvLCAkYWN0aW9ucywgJGFjdGlvbiwgJGJsb2d2ZXJzaW9uLCAkYmxvZ3RpdGxlLCAkYmxvZ25hbWUsICRibG9nc3VibmFtZSwNCiAgICAgICAgJGJsb2d0aGVtZSwgJGJsb2dzdHlsZSwgJGN1cnJlbnR1cmwsICRhY3RpdmVkYXBwcywgJHBvc3R0eXBlOw0KDQogICAgICAgIGlmIChaQlBfSE9PS0VSUk9SKSB7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6U2V0RXJyb3JIb29rKCk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+WfuuacrOmFjee9ruWKoOi9veWIsCR6YnDlhoUNCiAgICAgICAgJHRoaXMtPnZlcnNpb24gPSAmJGJsb2d2ZXJzaW9uOw0KICAgICAgICAkdGhpcy0+b3B0aW9uID0gJiRvcHRpb247DQogICAgICAgICR0aGlzLT5sYW5nID0gJiRsYW5nOw0KICAgICAgICAkdGhpcy0+bGFuZ3MgPSAmJGxhbmdzOw0KICAgICAgICAkdGhpcy0+cGF0aCA9ICYkYmxvZ3BhdGg7DQogICAgICAgICR0aGlzLT5ob3N0ID0gJiRibG9naG9zdDsgLy/mraTlgLzlnKjlkI7ovrnliJ3lp4vljJbml7blj6/og73kvJrlj5jljJYhDQogICAgICAgICR0aGlzLT5jb29raWVzcGF0aCA9ICYkY29va2llc3BhdGg7DQogICAgICAgICR0aGlzLT51c2Vyc2RpciA9ICYkdXNlcnNkaXI7DQoNCiAgICAgICAgJHRoaXMtPnRhYmxlID0gJiR0YWJsZTsNCiAgICAgICAgJHRoaXMtPmRhdGFpbmZvID0gJiRkYXRhaW5mbzsNCiAgICAgICAgJHRoaXMtPmFjdGlvbnMgPSAmJGFjdGlvbnM7DQogICAgICAgICR0aGlzLT5wb3N0dHlwZSA9ICYkcG9zdHR5cGU7DQogICAgICAgICR0aGlzLT5jdXJyZW50dXJsID0gJiRjdXJyZW50dXJsOw0KDQogICAgICAgICR0aGlzLT5hY3Rpb24gPSAmJGFjdGlvbjsNCiAgICAgICAgJHRoaXMtPmFjdGl2ZWRhcHBzID0gJiRhY3RpdmVkYXBwczsNCiAgICAgICAgJHRoaXMtPmFjdGl2ZWFwcHMgPSAmJHRoaXMtPmFjdGl2ZWRhcHBzOw0KDQogICAgICAgICR0aGlzLT5ndWlkID0gJiR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXTsNCg0KICAgICAgICAkdGhpcy0+dGl0bGUgPSAmJGJsb2d0aXRsZTsNCiAgICAgICAgJHRoaXMtPm5hbWUgPSAmJGJsb2duYW1lOw0KICAgICAgICAkdGhpcy0+c3VibmFtZSA9ICYkYmxvZ3N1Ym5hbWU7DQogICAgICAgICR0aGlzLT50aGVtZSA9ICYkYmxvZ3RoZW1lOw0KICAgICAgICAkdGhpcy0+c3R5bGUgPSAmJGJsb2dzdHlsZTsNCg0KICAgICAgICAkdGhpcy0+bWFuYWdlY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfTUFOQUdFX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5wYWdlYmFyY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfUEFHRUJBUl9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+c2VhcmNoY291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfU0VBUkNIX0NPVU5UJ107DQogICAgICAgICR0aGlzLT5kaXNwbGF5Y291bnQgPSAmJHRoaXMtPm9wdGlvblsnWkNfRElTUExBWV9DT1VOVCddOw0KICAgICAgICAkdGhpcy0+Y29tbWVudGRpc3BsYXljb3VudCA9ICYkdGhpcy0+b3B0aW9uWydaQ19DT01NRU5UU19ESVNQTEFZX0NPVU5UJ107DQoNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXMgPSAmJHRoaXMtPmNhdGVnb3J5czsNCiAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyID0gJiR0aGlzLT5jYXRlZ29yeXNieW9yZGVyOw0KDQogICAgICAgICR0aGlzLT51c2VyID0gbmV3IHN0ZENsYXNzKCk7DQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5kYXRhaW5mb1snTWVtYmVyJ10gYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICR0aGlzLT51c2VyLT4ka2V5ID0gJHZhbHVlWzNdOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT51c2VyLT5NZXRhcyA9IG5ldyBNZXRhcygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq5p6Q5p6E5Ye95pWw77yM6YeK5pS+6LWE5rqQLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2Rlc3RydWN0KCkNCiAgICB7DQogICAgICAgICR0aGlzLT5UZXJtaW5hdGUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX0NhbGwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbWV0aG9kDQogICAgICogQHBhcmFtICRhcmdzDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY2FsbCgkbWV0aG9kLCAkYXJncykNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9DYWxsJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRtZXRob2QsICRhcmdzKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7lj4LmlbDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSAkbmFtZQ0KICAgICAqIEBwYXJhbSAkdmFsdWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19zZXQoJG5hbWUsICR2YWx1ZSkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TZXQnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJG5hbWUsICR2YWx1ZSk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHRyaWdnZXJfZXJyb3IoJHRoaXMtPmxhbmdbJ2Vycm9yJ11bODFdLCBFX1VTRVJfV0FSTklORyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+W5Y+C5pWw5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0gJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gbWl4ZWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gX19nZXQoJG5hbWUpDQogICAgew0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfR2V0J10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRuYW1lKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdHJpZ2dlcl9lcnJvcigkdGhpcy0+bGFuZ1snZXJyb3InXVs4MV0sIEVfVVNFUl9XQVJOSU5HKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliJ3lp4vljJYkemJwLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBJbml0aWFsaXplKCkNCiAgICB7DQogICAgICAgICRvbGRab25lID0gJHRoaXMtPm9wdGlvblsnWkNfVElNRV9aT05FX05BTUUnXTsNCiAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgkb2xkWm9uZSk7DQoNCiAgICAgICAgJG9sZExhbmcgPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0xBTkdVQUdFUEFDSyddOw0KICAgICAgICAkdGhpcy0+TG9hZExhbmd1YWdlKCdzeXN0ZW0nLCAnJyk7DQoNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0NMT1NFX1dIT0xFX1NJVEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICBIdHRwNTAzKCk7DQogICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDgyLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoISR0aGlzLT5PcGVuQ29ubmVjdCgpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+Q29udmVydFRhYmxlQW5kRGF0YWluZm8oKTsNCg0KICAgICAgICAkdGhpcy0+TG9hZENvbmZpZ3NPbmx5U3lzdGVtKHRydWUpOw0KICAgICAgICAkdGhpcy0+TG9hZE9wdGlvbigpOw0KDQogICAgICAgICR0aGlzLT5SZWdQb3N0VHlwZSgwLCAnYXJ0aWNsZScsICR0aGlzLT5vcHRpb25bJ1pDX0FSVElDTEVfUkVHRVgnXSwgJHRoaXMtPm9wdGlvblsnWkNfUE9TVF9ERUZBVUxUX1RFTVBMQVRFJ10sIDAsIDApOw0KICAgICAgICAkdGhpcy0+UmVnUG9zdFR5cGUoMSwgJ3BhZ2UnLCAkdGhpcy0+b3B0aW9uWydaQ19QQUdFX1JFR0VYJ10sICR0aGlzLT5vcHRpb25bJ1pDX1BPU1RfREVGQVVMVF9URU1QTEFURSddLCBudWxsLCBudWxsKTsNCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9PT0gJ1NpbXBDaGluZXNlJykgew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9ICd6aC1jbic7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9PT0gJ1RyYWRDaGluZXNlJykgew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSA9ICd6aC10dyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJG9sZExhbmcgIT0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXSkgew0KICAgICAgICAgICAgJHRoaXMtPkxvYWRMYW5ndWFnZSgnc3lzdGVtJywgJycpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfV0FSTklORyddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc3dhcm5pbmcgPSAoYm9vbCkgJHRoaXMtPm9wdGlvblsnWkNfREVCVUdfTU9ERV9XQVJOSU5HJ107DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfU1RSSUNUJ10pKSB7DQogICAgICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGlzc3RyaWN0ID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX01PREVfU1RSSUNUJ107DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX0xPR19FUlJPUiddKSkgew0KICAgICAgICAgICAgWkJsb2dFeGNlcHRpb246OiRpc2xvZ2Vycm9yID0gKGJvb2wpICR0aGlzLT5vcHRpb25bJ1pDX0RFQlVHX0xPR19FUlJPUiddOw0KICAgICAgICB9DQoNCiAgICAgICAgLy9aQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEXkuI3lrZjlnKgg5oiW5pivIFpDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMReWtmOWcqOS9huS4uuWBhw0KICAgICAgICAkZG9tYWluX2Rpc2FibGUgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwnWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJyk7DQogICAgICAgIGlmICgkZG9tYWluX2Rpc2FibGUgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIC8v5aaC5p6cWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJM5a2Y5ZyoIOS4lOS4jeS4uuepug0KICAgICAgICAgICAgJGZvcmNlZF91cmwgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJyk7DQogICAgICAgICAgICBpZiAoJGZvcmNlZF91cmwgIT0gJycpew0KICAgICAgICAgICAgICAgICR0aGlzLT5ob3N0ID0gKHN0cmluZykgJGZvcmNlZF91cmw7DQogICAgICAgICAgICAgICAgJHRoaXMtPmNvb2tpZXNwYXRoID0gc3Ryc3RyKHN0cl9yZXBsYWNlKCc6Ly8nLCAnJywgJHRoaXMtPmhvc3QpLCAnLycpOw0KICAgICAgICAgICAgLy/lpoLmnpxaQ19QRVJNQU5FTlRfRE9NQUlOX0VOQUJMReW3suW8gOWQr+eahOivnQ0KICAgICAgICAgICAgfWVsc2VpZiAoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9FTkFCTEUnXSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPmhvc3QgPSAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXTsNCiAgICAgICAgICAgICAgICAkdGhpcy0+Y29va2llc3BhdGggPSBzdHJzdHIoc3RyX3JlcGxhY2UoJzovLycsICcnLCAkdGhpcy0+aG9zdCksICcvJyk7DQogICAgICAgICAgICAvL+m7mOiupOiHquWKqOivhuWIq+Wfn+WQjQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX0hPU1QnXSA9ICR0aGlzLT5ob3N0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfQkxPR19IT1NUJ10gPSAkdGhpcy0+aG9zdDsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVCddID0gJ1otQmxvZ1BIUCc7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfVkVSU0lPTiddID0gWkNfQkxPR19WRVJTSU9OOw0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19OT1dfVkVSU0lPTiddID0gJHRoaXMtPnZlcnNpb247ICAvL1pDX0xBU1RfVkVSU0lPTg0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddID0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUJ10gLiAnICcgLiBaQ19WRVJTSU9OX0RJU1BMQVk7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfUFJPRFVDVF9GVUxMSFRNTCddID0gJzxhIGhyZWY9Imh0dHBzOi8vd3d3LnpibG9nY24uY29tLyIgdGl0bGU9IlotQmxvZ1BIUCAnIC4gWkNfQkxPR19WRVJTSU9OIC4gJyIgdGFyZ2V0PSJfYmxhbmsiPicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfRlVMTCddIC4gJzwvYT4nOw0KICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1RfSFRNTCddID0gJzxhIGhyZWY9Imh0dHBzOi8vd3d3LnpibG9nY24uY29tLyIgdGl0bGU9IlotQmxvZ1BIUCAnIC4gWkNfQkxPR19WRVJTSU9OIC4gJyIgdGFyZ2V0PSJfYmxhbmsiPicgLiAkdGhpcy0+b3B0aW9uWydaQ19CTE9HX1BST0RVQ1QnXSAuICc8L2E+JzsNCg0KICAgICAgICBpZiAoJG9sZFpvbmUgIT0gJHRoaXMtPm9wdGlvblsnWkNfVElNRV9aT05FX05BTUUnXSkgew0KICAgICAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgkdGhpcy0+b3B0aW9uWydaQ19USU1FX1pPTkVfTkFNRSddKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qaWYoaXNzZXQoJF9DT09LSUVbJ3RpbWV6b25lJ10pKXsNCiAgICAgICAgICAgICR0ej1HZXRWYXJzKCd0aW1lem9uZScsJ0NPT0tJRScpOw0KICAgICAgICAgICAgaWYoaXNfbnVtZXJpYygkdHopKXsNCiAgICAgICAgICAgICR0ej1zcHJpbnRmKCclK2QnLC0kdHopOw0KICAgICAgICAgICAgZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgnRXRjL0dNVCcgLiAkdHopOw0KICAgICAgICAgICAgJHRoaXMtPnRpbWV6b25lPWRhdGVfZGVmYXVsdF90aW1lem9uZV9nZXQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgKi8NCg0KICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfVkVSU0lPTl9JTl9IRUFERVInXSAmJiAhaGVhZGVyc19zZW50KCkpIHsNCiAgICAgICAgICAgIGhlYWRlcignUHJvZHVjdDonIC4gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19QUk9EVUNUX0ZVTEwnXSk7DQogICAgICAgIH0NCg0KICAgICAgICAkcGFyc2VkSG9zdCA9IHBhcnNlX3VybCgkdGhpcy0+aG9zdCk7DQogICAgICAgICR0aGlzLT5mdWxsY3VycmVudHVybCA9ICRwYXJzZWRIb3N0WydzY2hlbWUnXSAuICc6Ly8nIC4gJHBhcnNlZEhvc3RbJ2hvc3QnXTsNCiAgICAgICAgaWYgKGlzc2V0KCRwYXJzZWRIb3N0Wydwb3J0J10pKSB7DQogICAgICAgICAgICAkdGhpcy0+ZnVsbGN1cnJlbnR1cmwgLj0gJzonIC4gJHBhcnNlZEhvc3RbJ3BvcnQnXTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+ZnVsbGN1cnJlbnR1cmwgLj0gJHRoaXMtPmN1cnJlbnR1cmw7DQoNCiAgICAgICAgaWYgKHN1YnN0cigkdGhpcy0+aG9zdCwgMCwgOCkgPT0gJ2h0dHBzOi8vJykgew0KICAgICAgICAgICAgJHRoaXMtPmlzSHR0cHMgPSB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPnZlcmlmeUNvZGVVcmwgPSAkdGhpcy0+aG9zdCAuICd6Yl9zeXN0ZW0vc2NyaXB0L2NfdmFsaWRjb2RlLnBocCc7DQogICAgICAgICR0aGlzLT52YWxpZGNvZGV1cmwgPSAmJHRoaXMtPnZlcmlmeUNvZGVVcmw7DQogICAgICAgICR0aGlzLT5mZWVkdXJsID0gJHRoaXMtPmhvc3QgLiAnZmVlZC5waHAnOw0KICAgICAgICAkdGhpcy0+c2VhcmNodXJsID0gJHRoaXMtPmhvc3QgLiAnc2VhcmNoLnBocCc7DQogICAgICAgICR0aGlzLT5hamF4dXJsID0gJHRoaXMtPmhvc3QgLiAnemJfc3lzdGVtL2NtZC5waHA/YWN0PWFqYXgmc3JjPSc7DQogICAgICAgICR0aGlzLT54bWxycGN1cmwgPSAkdGhpcy0+aG9zdCAuICd6Yl9zeXN0ZW0veG1sLXJwYy9pbmRleC5waHAnOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0oZmFsc2UpOw0KDQogICAgICAgICR0aGlzLT5Mb2FkQ2FjaGUoKTsNCg0KICAgICAgICAhZGVmaW5lZCgnWkJQX0lOX0NNRCcpIHx8ICR0aGlzLT5pc2NtZCA9IHRydWU7DQogICAgICAgICFkZWZpbmVkKCdaQlBfSU5fQUpBWCcpIHx8ICR0aGlzLT5pc2FqYXggPSB0cnVlOw0KDQogICAgICAgICR0aGlzLT5pc2luaXRpYWxpemVkID0gdHJ1ZTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDku47mlbDmja7lupPph4zor7vlj5bkv6Hmga/vvIzlkK/liqjmlbTkuKpaQlAuDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWQoKQ0KICAgIHsNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0xvYWRfUHJlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCEkdGhpcy0+aXNpbml0aWFsaXplZCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCR0aGlzLT5pc2xvYWQpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5TdGFydEd6aXAoKTsNCg0KICAgICAgICBpZiAoIWhlYWRlcnNfc2VudCgpKSB7DQogICAgICAgICAgICBoZWFkZXIoJ0NvbnRlbnQtdHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Jyk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+Q29udmVydFRhYmxlQW5kRGF0YWluZm8oKTsNCg0KICAgICAgICAkdGhpcy0+TG9hZE1lbWJlcnMoJHRoaXMtPm9wdGlvblsnWkNfTE9BRE1FTUJFUlNfTEVWRUwnXSk7DQogICAgICAgICR0aGlzLT5Mb2FkQ2F0ZWdvcmllcygpOw0KICAgICAgICAvLyR0aGlzLT5Mb2FkVGFncygpOw0KICAgICAgICAkdGhpcy0+TG9hZE1vZHVsZXMoKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlcygpOw0KDQogICAgICAgIGlmICghKGdldF9jbGFzcygkdGhpcy0+dXNlcikgPT09ICdNZW1iZXInICYmICR0aGlzLT51c2VyLT5MZXZlbCA+IDAgJiYgIWVtcHR5KCR0aGlzLT51c2VyLT5JRCkpKSB7DQogICAgICAgICAgICAkdGhpcy0+VmVyaWZ5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAvL+WIm+W7uuaooeadv+exuw0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUgPSAkdGhpcy0+UHJlcGFyZVRlbXBsYXRlKCk7DQoNCiAgICAgICAgLy8g6K+75Li76aKY54mI5pys5L+h5oGvDQogICAgICAgICR0aGlzLT50aGVtZWFwcCA9ICR0aGlzLT5Mb2FkQXBwKCd0aGVtZScsICR0aGlzLT50aGVtZSk7DQogICAgICAgICR0aGlzLT50aGVtZWluZm8gPSAkdGhpcy0+dGhlbWVhcHAtPkdldEluZm9BcnJheSgpOw0KDQogICAgICAgIGlmICgkdGhpcy0+aXNtYW5hZ2UpIHsNCiAgICAgICAgICAgICR0aGlzLT5Mb2FkTWFuYWdlKCk7DQogICAgICAgIH0NCg0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9Mb2dpbl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9PdGhlcl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9IZWFkZXInLCAnSW5jbHVkZV9BZGRvbkFkbWluRm9udCcpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+UmVmbHVzaExhbmd1YWdlcygpOw0KDQogICAgICAgIC8v6L+b5ZCO5Y+w5pe25bey6Ieq5Yqo5qOA5rWL5qih5p2/5bm26Ieq5Yqo6YeN5bu65LqG77yM5omA5Lul6L+Z6YeM5Y+q6ZKI5a+55byA6LCD6K+V5ZCO55qE5YmN5Y+w55qE6K6/6Zeu6L+b6KGMDQogICAgICAgIGlmICgkdGhpcy0+b3B0aW9uWydaQ19ERUJVR19NT0RFJ10gJiYgJHRoaXMtPmlzbWFuYWdlID09IGZhbHNlKSB7DQogICAgICAgICAgICAkdGhpcy0+Q2hlY2tUZW1wbGF0ZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRoaXMtPmlzbG9hZCA9IHRydWU7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl566h55CGLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZE1hbmFnZSgpDQogICAgew0KICAgICAgICAvL2lmICgkdGhpcy0+b3B0aW9uWydaQ19QRVJNQU5FTlRfRE9NQUlOX1dJVEhfQURNSU4nXSA9PSBmYWxzZSkgew0KICAgICAgICAvLyAgICAgJHRoaXMtPmhvc3QgPSBHZXRDdXJyZW50SG9zdCgkdGhpcy0+cGF0aCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCiAgICAgICAgLy99DQoNCiAgICAgICAgLy9pZiAoc3Vic3RyKCR0aGlzLT5ob3N0LCAwLCA4KSA9PSAnaHR0cHM6Ly8nKSB7DQogICAgICAgIC8vICAgICR0aGlzLT5pc0h0dHBzID0gdHJ1ZTsNCiAgICAgICAgLy99DQoNCiAgICAgICAgaWYgKCR0aGlzLT51c2VyLT5TdGF0dXMgPT0gWkNfTUVNQkVSX1NUQVRVU19BVURJVElORykgew0KICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig3OSwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkdGhpcy0+dXNlci0+U3RhdHVzID09IFpDX01FTUJFUl9TVEFUVVNfTE9DS0VEKSB7DQogICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDgwLCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICB9DQoNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fUGFnZU1uZ19TdWJNZW51JywgJ0luY2x1ZGVfQWRtaW5fQWRkcGFnZXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fVGFnTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGR0YWdzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NhdGVnb3J5TW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRjYXRlc3VibWVudScpOw0KICAgICAgICBBZGRfRmlsdGVyX1BsdWdpbignRmlsdGVyX1BsdWdpbl9BZG1pbl9NZW1iZXJNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZG1lbXN1Ym1lbnUnKTsNCiAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fQWRtaW5fTW9kdWxlTW5nX1N1Yk1lbnUnLCAnSW5jbHVkZV9BZG1pbl9BZGRtb2RzdWJtZW51Jyk7DQogICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0FkbWluX0NvbW1lbnRNbmdfU3ViTWVudScsICdJbmNsdWRlX0FkbWluX0FkZGNtdHN1Ym1lbnUnKTsNCg0KICAgICAgICAkdGhpcy0+Q2hlY2tUZW1wbGF0ZSgpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9Mb2FkTWFuYWdlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnu4jmraLov57mjqXvvIzph4rmlL7otYTmupAuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFRlcm1pbmF0ZSgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzaW5pdGlhbGl6ZWQpIHsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9UZXJtaW5hdGUnXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICAgICAkZnBuYW1lKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5DbG9zZUNvbm5lY3QoKTsNCiAgICAgICAgICAgIHVuc2V0KCR0aGlzLT5kYik7DQogICAgICAgICAgICAkdGhpcy0+aXNpbml0aWFsaXplZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L+e5o6l5pWw5o2u5bqTLg0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBPcGVuQ29ubmVjdCgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzY29ubmVjdGVkKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoISR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgc3dpdGNoICgkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pIHsNCiAgICAgICAgICAgIGNhc2UgJ3NxbGl0ZSc6DQogICAgICAgICAgICBjYXNlICdzcWxpdGUzJzoNCiAgICAgICAgICAgIGNhc2UgJ3Bkb19zcWxpdGUnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oYXJyYXkoDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT51c2Vyc2RpciAuICdkYXRhLycgLiAkdGhpcy0+b3B0aW9uWydaQ19TUUxJVEVfTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19TUUxJVEVfUFJFJ10sDQogICAgICAgICAgICAgICAgKSkgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig2OSwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdwZ3NxbCc6DQogICAgICAgICAgICBjYXNlICdwZG9fcGdzcWwnOg0KICAgICAgICAgICAgICAgICR0aGlzLT5kYiA9IHNlbGY6OkluaXRpYWxpemVEQigkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10pOw0KICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+ZGItPk9wZW4oYXJyYXkoDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1NFUlZFUiddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9VU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QQVNTV09SRCddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9OQU1FJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BSRSddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19QR1NRTF9QT1JUJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX1BHU1FMX1BFUlNJU1RFTlQnXSwNCiAgICAgICAgICAgICAgICApKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDY3LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ215c3FsJzoNCiAgICAgICAgICAgIGNhc2UgJ215c3FsaSc6DQogICAgICAgICAgICBjYXNlICdwZG9fbXlzcWwnOg0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddID09ICdteXNxbCcgJiYgdmVyc2lvbl9jb21wYXJlKFBIUF9WRVJTSU9OLCAnNy4wLjAnKSA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb25fbG9hZGVkKCdteXNxbGknKSl7DQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19EQVRBQkFTRV9UWVBFJ10gPSAnbXlzcWxpJzsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgncGRvX215c3FsJykpew0KICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfREFUQUJBU0VfVFlQRSddID0gJ3Bkb19teXNxbCc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHRoaXMtPmRiID0gc2VsZjo6SW5pdGlhbGl6ZURCKCR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSk7DQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5kYi0+T3BlbihhcnJheSgNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfU0VSVkVSJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1VTRVJOQU1FJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BBU1NXT1JEJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX05BTUUnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUFJFJ10sDQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX01ZU1FMX1BPUlQnXSwNCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm9wdGlvblsnWkNfTVlTUUxfUEVSU0lTVEVOVCddLA0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19NWVNRTF9FTkdJTkUnXSwNCiAgICAgICAgICAgICAgICApKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2hvd0Vycm9yKDY3LCBfX0ZJTEVfXywgX19MSU5FX18pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgICAgICAvLyB1dGY4bWI05pSv5oyBDQogICAgICAgIGlmICgkdGhpcy0+ZGItPnR5cGUgPT0gJ215c3FsJyAmJiB2ZXJzaW9uX2NvbXBhcmUoJHRoaXMtPmRiLT52ZXJzaW9uLCAnNS41LjMnKSA8IDApIHsNCiAgICAgICAgICAgIEFkZF9GaWx0ZXJfUGx1Z2luKCdGaWx0ZXJfUGx1Z2luX0RiU3FsX0ZpbHRlcicsICd1dGY4NG1iX2ZpbHRlcicpOw0KICAgICAgICAgICAgQWRkX0ZpbHRlcl9QbHVnaW4oJ0ZpbHRlcl9QbHVnaW5fRWRpdF9CZWdpbicsICd1dGY4NG1iX2ZpeEh0bWxTcGVjaWFsQ2hhcnMnKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+aXNjb25uZWN0ZWQgPSB0cnVlOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWvueihqOWQjeWSjOaVsOaNrue7k+aehOi/m+ihjOmihOi9rOaNoi4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ29udmVydFRhYmxlQW5kRGF0YWluZm8oKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5kYi0+ZGJwcmUpIHsNCiAgICAgICAgICAgICR0aGlzLT50YWJsZSA9IHN0cl9yZXBsYWNlKCclcHJlJScsICR0aGlzLT5kYi0+ZGJwcmUsICR0aGlzLT50YWJsZSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCR0aGlzLT5kYi0+dHlwZSA9PT0gJ3Bvc3RncmVzcWwnKSB7DQogICAgICAgICAgICBmb3JlYWNoICgkdGhpcy0+ZGF0YWluZm8gYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHZhbHVlIGFzICRrMiA9PiAmJHYyKSB7DQogICAgICAgICAgICAgICAgICAgICR2MlswXSA9IHN0cnRvbG93ZXIoJHYyWzBdKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlhbPpl63mlbDmja7lupPov57mjqUuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENsb3NlQ29ubmVjdCgpDQogICAgew0KICAgICAgICBpZiAoJHRoaXMtPmlzY29ubmVjdGVkKSB7DQogICAgICAgICAgICAkdGhpcy0+ZGItPkNsb3NlKCk7DQogICAgICAgICAgICAkdGhpcy0+aXNjb25uZWN0ZWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWQr+eUqHNlc3Npb24uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU3RhcnRTZXNzaW9uKCkNCiAgICB7DQogICAgICAgIGlmIChzZXNzaW9uX3N0YXR1cygpID09IDEpIHsNCiAgICAgICAgICAgIHNlc3Npb25fc3RhcnQoKTsNCiAgICAgICAgICAgICR0aGlzLT5pc3Nlc3Npb24gPSB0cnVlOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnu4jmraJzZXNzaW9uLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEVuZFNlc3Npb24oKQ0KICAgIHsNCiAgICAgICAgaWYgKHNlc3Npb25fc3RhdHVzKCkgPT0gMikgew0KICAgICAgICAgICAgc2Vzc2lvbl93cml0ZV9jbG9zZSgpOw0KICAgICAgICAgICAgJHRoaXMtPmlzc2Vzc2lvbiA9IGZhbHNlOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBMb2FkIG9yIFJlTG9hZOaPkuS7tkNvbmZpZ3PooaguDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRDb25maWdzKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0odHJ1ZSk7DQogICAgICAgICR0aGlzLT5Mb2FkQ29uZmlnc09ubHlTeXN0ZW0oZmFsc2UpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaPkuS7tkNvbmZpZ3PooaggT25seSBTeXN0ZW0gT3B0aW9uLg0KICAgICAqLw0KICAgIHByaXZhdGUgJHBydkNvbmZpZ0xpc3QgPSBhcnJheSgpOw0KDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRDb25maWdzT25seVN5c3RlbSgkb25seXN5c3RlbW9wdGlvbiA9IHRydWUpDQogICAgew0KICAgICAgICBpZiAoJG9ubHlzeXN0ZW1vcHRpb24gPT0gdHJ1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPmNvbmZpZ3MgPSBhcnJheSgpOw0KICAgICAgICAgICAgJHRoaXMtPnBydkNvbmZpZ0xpc3QgPSBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydDb25maWcnXSwgJycsICcnLCAnJywgJycsICcnKTsNCiAgICAgICAgJHR5cGUgPSAnQ29uZmlnJzsNCg0KICAgICAgICAvKiBAdmFyIENvbmZpZ1tdICRhcnJheSAqLw0KICAgICAgICAkdGhpcy0+cHJ2Q29uZmlnTGlzdCA9ICR0aGlzLT5HZXRMaXN0T3JpZ2luKCRzcWwpOw0KICAgICAgICBmb3JlYWNoICgkdGhpcy0+cHJ2Q29uZmlnTGlzdCBhcyAkYykgew0KICAgICAgICAgICAgJG5hbWUgPSAkY1snY29uZl9OYW1lJ107DQogICAgICAgICAgICBpZiAoKCRuYW1lID09ICdzeXN0ZW0nICYmICRvbmx5c3lzdGVtb3B0aW9uID09IHRydWUpIHx8ICgkbmFtZSAhPSAnc3lzdGVtJyAmJiAkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkbCA9ICR0aGlzLT5jb25maWdzWyRuYW1lXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGdldF9jbGFzcygkbCkgIT0gJHR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgJGwgPSBuZXcgJHR5cGUoJG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSAkbDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRjKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkb25seXN5c3RlbW9wdGlvbiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgJHRoaXMtPnBydkNvbmZpZ0xpc3QgPSBhcnJheSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5L+d5a2YQ29uZmlnc+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgQ29uZmlnc+ihqOWQjQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNhdmVDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+U2F2ZSgpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpENvbmZpZ3PooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIENvbmZpZ3PooajlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBEZWxDb25maWcoJG5hbWUpDQogICAgew0KICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5jb25maWdzWyRuYW1lXS0+RGVsZXRlKCk7DQogICAgICAgIHVuc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ29uZmlnc+ihqOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENvbmZpZygkbmFtZSkNCiAgICB7DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmNvbmZpZ3NbJG5hbWVdKSkgew0KICAgICAgICAgICAgJG5hbWUgPSBGaWx0ZXJDb3JyZWN0TmFtZSgkbmFtZSk7DQogICAgICAgICAgICBpZiAoISRuYW1lKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkdGhpcy0+Y29uZmlnc1skbmFtZV0gPSBuZXcgQ29uZmlnKCRuYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkdGhpcy0+Y29uZmlnc1skbmFtZV07DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l5p+QQ29uZmln5piv5ZCm5a2Y5ZyoLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSBDb25maWdz6KGo5ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSGFzQ29uZmlnKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5jb25maWdzWyRuYW1lXSkgJiYgJHRoaXMtPmNvbmZpZ3NbJG5hbWVdLT5Db3VudEl0ZW0oKSA+IDA7DQogICAgfQ0KDQogICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAgICAvL0NhY2hl55u45YWzDQogICAgcHJpdmF0ZSAkY2FjaGVfaGFzaCA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjnvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2F2ZUNhY2hlKCkNCiAgICB7DQogICAgICAgIC8vJHM9JHRoaXMtPnVzZXJzZGlyIC4gJ2NhY2hlLycgLiAkdGhpcy0+Z3VpZCAuICcuY2FjaGUnOw0KICAgICAgICAvLyRjPXNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUpOw0KICAgICAgICAvL0BmaWxlX3B1dF9jb250ZW50cygkcywgJGMpOw0KICAgICAgICAvLyR0aGlzLT5jb25maWdzWydjYWNoZSddPSR0aGlzLT5jYWNoZTsNCiAgICAgICAgJG5ld19oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KICAgICAgICBpZiAoJHRoaXMtPmNhY2hlX2hhc2ggPT0gJG5ld19oYXNoKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0aGlzLT5TYXZlQ29uZmlnKCdjYWNoZScpOw0KICAgICAgICAkdGhpcy0+Y2FjaGVfaGFzaCA9ICRuZXdfaGFzaDsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDliqDovb3nvJPlrZguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZENhY2hlKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5jYWNoZSA9ICR0aGlzLT5Db25maWcoJ2NhY2hlJyk7DQogICAgICAgICR0aGlzLT5jYWNoZV9oYXNoID0gbWQ1KCR0aGlzLT5Db25maWcoJ2NhY2hlJykpOw0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmOmFjee9ri4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTYXZlT3B0aW9uKCkNCiAgICB7DQogICAgICAgICR0aGlzLT5vcHRpb25bJ1pDX0JMT0dfQ0xTSUQnXSA9ICR0aGlzLT5ndWlkOw0KDQogICAgICAgIHVuc2V0KCR0aGlzLT5vcHRpb25bJ1pDX1BFUk1BTkVOVF9ET01BSU5fV0hPTEVfRElTQUJMRSddKTsNCiAgICAgICAgdW5zZXQoJHRoaXMtPm9wdGlvblsnWkNfUEVSTUFORU5UX0RPTUFJTl9GT1JDRURfVVJMJ10pOw0KDQogICAgICAgIGlmIChmaWxlX2V4aXN0cygkdGhpcy0+dXNlcnNkaXIgLiAnY19vcHRpb24ucGhwJykgPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICRzID0gIjwiIC4gIj8iIC4gInBocFxyXG4iOw0KICAgICAgICAgICAgJHMgLj0gInJldHVybiAiOw0KICAgICAgICAgICAgJG9wdGlvbiA9IGFycmF5KCk7DQogICAgICAgICAgICBmb3JlYWNoICgkdGhpcy0+b3B0aW9uIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKCgka2V5ID09ICdaQ19EQVRBQkFTRV9UWVBFJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1NRTElURV9OQU1FJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1NRTElURV9QUkUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfU0VSVkVSJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX1VTRVJOQU1FJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX1BBU1NXT1JEJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX05BTUUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfQ0hBUlNFVCcpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9QUkUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfRU5HSU5FJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX1BPUlQnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfUEVSU0lTVEVOVCcpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9TRVJWRVInKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfVVNFUk5BTUUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfUEFTU1dPUkQnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfTkFNRScpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9DSEFSU0VUJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1BSRScpIHx8DQogICAgICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9QT1JUJykgfHwNCiAgICAgICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1BFUlNJU1RFTlQnKSB8fA0KICAgICAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfQ0xPU0VfV0hPTEVfU0lURScpDQogICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgICAgICRvcHRpb25bJGtleV0gPSAkdmFsdWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHMgLj0gdmFyX2V4cG9ydCgkb3B0aW9uLCB0cnVlKTsNCiAgICAgICAgICAgICRzIC49ICI7IjsNCiAgICAgICAgICAgIEBmaWxlX3B1dF9jb250ZW50cygkdGhpcy0+dXNlcnNkaXIgLiAnY19vcHRpb24ucGhwJywgJHMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPm9wdGlvbiBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPiRrZXkgPSAkdmFsdWU7DQogICAgICAgIH0NCg0KICAgICAgICAkdGhpcy0+Q29uZmlnKCdzeXN0ZW0nKS0+WkNfQkxPR19IT1NUID0gY2h1bmtfc3BsaXQoJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPlpDX0JMT0dfSE9TVCwgMSwgInwiKTsNCg0KICAgICAgICAkdGhpcy0+U2F2ZUNvbmZpZygnc3lzdGVtJyk7DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl6YWN572uLg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRPcHRpb24oKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkNvbmZpZygnc3lzdGVtJyktPkdldERhdGEoKTsNCg0KICAgICAgICBpZiAoZW1wdHkoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJyYXkpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgIC8vaWYoJGtleT09J1pDX1BFUk1BTkVOVF9ET01BSU5fRU5BQkxFJyljb250aW51ZTsNCiAgICAgICAgICAgIC8vaWYoJGtleT09J1pDX0JMT0dfSE9TVCcpY29udGludWU7DQogICAgICAgICAgICAvL2lmKCRrZXk9PSdaQ19CTE9HX0NMU0lEJyljb250aW51ZTsNCiAgICAgICAgICAgIC8vaWYoJGtleT09J1pDX0JMT0dfTEFOR1VBR0VQQUNLJyljb250aW51ZTsNCiAgICAgICAgICAgIGlmICgka2V5ID09ICdaQ19CTE9HX0hPU1QnKSB7DQogICAgICAgICAgICAgICAgJHZhbHVlID0gc3RyX3JlcGxhY2UoJ3wnLCAnJywgJHZhbHVlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCgka2V5ID09ICdaQ19EQVRBQkFTRV9UWVBFJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfU1FMSVRFX05BTUUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19TUUxJVEVfUFJFJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfU0VSVkVSJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfVVNFUk5BTUUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9QQVNTV09SRCcpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX05BTUUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19NWVNRTF9DSEFSU0VUJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfUFJFJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfRU5HSU5FJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfTVlTUUxfUE9SVCcpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX01ZU1FMX1BFUlNJU1RFTlQnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9TRVJWRVInKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9VU0VSTkFNRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX1BBU1NXT1JEJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfTkFNRScpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX1BHU1FMX0NIQVJTRVQnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9QUkUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QR1NRTF9QT1JUJykgfHwNCiAgICAgICAgICAgICAgICAoJGtleSA9PSAnWkNfUEdTUUxfUEVSU0lTVEVOVCcpIHx8DQogICAgICAgICAgICAgICAgKCRrZXkgPT0gJ1pDX0NMT1NFX1dIT0xFX1NJVEUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QRVJNQU5FTlRfRE9NQUlOX1dIT0xFX0RJU0FCTEUnKSB8fA0KICAgICAgICAgICAgICAgICgka2V5ID09ICdaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkwnKQ0KICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICR0aGlzLT5vcHRpb25bJGtleV0gPSAkdmFsdWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFleHRlbnNpb25fbG9hZGVkKCdnZCcpKSB7DQogICAgICAgICAgICAkdGhpcy0+b3B0aW9uWydaQ19DT01NRU5UX1ZFUklGWV9FTkFCTEUnXSA9IGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B5pON5L2c5p2D6ZmQLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgJGFjdGlvbiDmk43kvZwNCiAgICAgKiBAcGFyYW0gaW50fHN0cmluZyAkbGV2ZWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRsZXZlbCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgJGxldmVsID0gJHRoaXMtPnVzZXItPkxldmVsOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrUmlnaHRzJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnByZXR1cm4gPSAkZnBuYW1lKCRhY3Rpb24sICRsZXZlbCk7DQogICAgICAgICAgICBpZiAoJGZwc2lnbmFsID09IFBMVUdJTl9FWElUU0lHTkFMX1JFVFVSTikgew0KICAgICAgICAgICAgICAgICRmcHNpZ25hbCA9IFBMVUdJTl9FWElUU0lHTkFMX05PTkU7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJGZwcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICghaXNzZXQoJHRoaXMtPmFjdGlvbnNbJGFjdGlvbl0pKSB7DQogICAgICAgICAgICBpZiAoaXNfbnVtZXJpYygkYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiAkbGV2ZWwgPD0gJGFjdGlvbjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsZXZlbCA8PSAkdGhpcy0+YWN0aW9uc1skYWN0aW9uXTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmoLnmja7nlKjmiLfnrYnnuqfpqozor4Hmk43kvZzmnYPpmZAgMS415byA5aeL5Y+C5pWw5o2i6aG65bqPLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkYWN0aW9uIOaTjeS9nA0KICAgICAqIEBwYXJhbSBpbnQgICAgJGxldmVsICDnlKjmiLfnrYnnuqcNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1JpZ2h0c0J5TGV2ZWwoJGFjdGlvbiwgJGxldmVsKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5DaGVja1JpZ2h0cygkYWN0aW9uLCAkbGV2ZWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9lS4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnkoKQ0KICAgIHsNCiAgICAgICAgJHVzZXJuYW1lID0gdHJpbShHZXRWYXJzKCd1c2VybmFtZScsICdDT09LSUUnKSk7DQogICAgICAgICR0b2tlbiA9IHRyaW0oR2V0VmFycygndG9rZW4nLCAnQ09PS0lFJykpOw0KICAgICAgICAkdXNlciA9ICR0aGlzLT5WZXJpZnlVc2VyVG9rZW4oJHRva2VuLCAkdXNlcm5hbWUpOw0KICAgICAgICBpZiAoIWlzX251bGwoJHVzZXIpKSB7DQogICAgICAgICAgICAkdGhpcy0+dXNlciA9ICR1c2VyOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+dXNlciA9IG5ldyBNZW1iZXIoKTsNCiAgICAgICAgJHRoaXMtPnVzZXItPkd1aWQgPSBHZXRHdWlkKCk7DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi/lOWbnueZu+W9leaIkOWKn+WQjuW6lOS/neWtmOeahGNvb2tpZeS/oeaBry4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBNZW1iZXIgJG0g5bey6aqM6L+H5oiQ5Yqf55qEbWVtYmVyDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWZXJpZnlSZXN1bHQoJG0pDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdlbmVyYXRlVXNlclRva2VuKCRtKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnlJ/miJBVc2VyIFRva2Vu77yM55So5LqO55m75b2V6aqM6K+BDQogICAgICoNCiAgICAgKiBAcGFyYW0gTWVtYmVyICR1c2VyDQogICAgICogQHBhcmFtIGludCAgICAkdGltZQ0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2VuZXJhdGVVc2VyVG9rZW4oJHVzZXIsICR0aW1lID0gMCkNCiAgICB7DQogICAgICAgIGlmICgkdGltZSA9PT0gMCkgew0KICAgICAgICAgICAgJHRpbWUgPSB0aW1lKCkgKyAzNjAwICogMjQ7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gQ3JlYXRlV2ViVG9rZW4oJHVzZXItPklELCAkdGltZSwgJHVzZXItPkd1aWQsICR1c2VyLT5QYXNzV29yZF9NRDVQYXRoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZVUb2tlbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHRva2VuDQogICAgICogQHBhcmFtIHN0cmluZyAkdXNlcm5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeVVzZXJUb2tlbigkdG9rZW4sICR1c2VybmFtZSkNCiAgICB7DQogICAgICAgICR1c2VyID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkdXNlcm5hbWUpOw0KICAgICAgICBpZiAoJHVzZXItPklEID4gMCkgew0KICAgICAgICAgICAgaWYgKFZlcmlmeVdlYlRva2VuKCR0b2tlbiwgJHVzZXItPklELCAkdXNlci0+R3VpZCwgJHVzZXItPlBhc3NXb3JkX01ENVBhdGgpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR1c2VyOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5LiA5qyhTUQ15a+G56CB77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgIOeUqOaIt+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG1kNXB3ICBtZDXliqDlr4blkI7nmoTlr4bnoIENCiAgICAgKiBAcGFyYW0gTWVtYmVyICRtZW1iZXIg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X01ENSgkbmFtZSwgJG1kNXB3LCAmJG1lbWJlcikNCiAgICB7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJyB8fCAkbWQ1cHcgPT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICAkbWVtYmVyID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbWVtYmVyLT5JRCA+IDApIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+VmVyaWZ5X0ZpbmFsKCRuYW1lLCBtZDUoJG1kNXB3IC4gJG1lbWJlci0+R3VpZCksICRtZW1iZXIpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOWOn+Wni+aYjuaWh+Wvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkb3JpZ2luYWxwdyDlr4bnoIHmmI7mlocNCiAgICAgKiBAcGFyYW0gTWVtYmVyICRtZW1iZXIgICAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9PcmlnaW5hbCgkbmFtZSwgJG9yaWdpbmFscHcsICYkbWVtYmVyID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJyB8fCAkb3JpZ2luYWxwdyA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gJHRoaXMtPkdldE1lbWJlckJ5TmFtZSgkbmFtZSk7DQogICAgICAgIGlmICgkbS0+SUQgPiAwKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeV9NRDUoJG5hbWUsIG1kNSgkb3JpZ2luYWxwdyksICRtZW1iZXIpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeeUqOaIt+eZu+W9le+8iOaVsOaNruW6k+S/neWtmOeahOacgOe7iOi/kOeul+WQjuWvhuegge+8iS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUgICAgIOeUqOaIt+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHBhc3N3b3JkIOS6jOasoeWKoOWvhuWQjueahOWvhueggQ0KICAgICAqIEBwYXJhbSBvYmplY3QgJG1lbWJlciAgIOi/lOWbnuivu+WPluaIkOWKn+eahG1lbWJlcuWvueixoQ0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeV9GaW5hbCgkbmFtZSwgJHBhc3N3b3JkLCAmJG1lbWJlciA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoJG5hbWUgPT0gJycgfHwgJHBhc3N3b3JkID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCA+IDApIHsNCiAgICAgICAgICAgIGlmIChzdHJjYXNlY21wKCRtLT5QYXNzd29yZCwgJHBhc3N3b3JkKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+B55So5oi355m75b2V77yI5L2/55SoVG9rZW7vvIzmm7/ku6Plr4bnoIHkv53lrZjvvIkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lICAg55So5oi35ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkd3QgICAgIFdlYlRva2VuDQogICAgICogQHBhcmFtIHN0cmluZyAkd3RfaWQgIFdlYlRva2Vu55qESUTor4bliKvnrKYNCiAgICAgKiBAcGFyYW0gb2JqZWN0ICRtZW1iZXIg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X1Rva2VuKCRuYW1lLCAkd3QsICR3dF9pZCwgJiRtZW1iZXIgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCRuYW1lID09ICcnIHx8ICR3dCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICRtID0gbnVsbDsNCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCA+IDApIHsNCiAgICAgICAgICAgIGlmIChWZXJpZnlXZWJUb2tlbigkd3QsICR3dF9pZCwgJHRoaXMtPmd1aWQsICRtLT5JRCwgJG0tPlBhc3N3b3JkKSA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICRtZW1iZXIgPSAkbTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeeUqOaIt+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGxldmVsIOeUqOaIt+etiee6pw0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRNZW1iZXJzKCRsZXZlbCA9IDApDQogICAgew0KICAgICAgICBpZiAoJGxldmVsIDwgMCkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgJHdoZXJlID0gbnVsbDsNCiAgICAgICAgaWYgKCRsZXZlbCA+IDApIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KGFycmF5KCc8PScsICdtZW1fTGV2ZWwnLCAkbGV2ZWwpKTsNCiAgICAgICAgfQ0KICAgICAgICAkdGhpcy0+bWVtYmVycyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldE1lbWJlckxpc3QobnVsbCwgJHdoZXJlKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRtKSB7DQogICAgICAgICAgICAkdGhpcy0+bWVtYmVyc1skbS0+SURdID0gJG07DQogICAgICAgICAgICAkdGhpcy0+bWVtYmVyc2J5bmFtZVskbS0+TmFtZV0gPSAmJHRoaXMtPm1lbWJlcnNbJG0tPklEXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeWIhuexu+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkQ2F0ZWdvcmllcygpDQogICAgew0KICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllcyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlciA9IGFycmF5KCk7DQogICAgICAgICRsdjAgPSBhcnJheSgpOw0KICAgICAgICAkbHYxID0gYXJyYXkoKTsNCiAgICAgICAgJGx2MiA9IGFycmF5KCk7DQogICAgICAgICRsdjMgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0Q2F0ZWdvcnlMaXN0KG51bGwsIG51bGwsIGFycmF5KCdjYXRlX09yZGVyJyA9PiAnQVNDJyksIG51bGwsIG51bGwpOw0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGMpIHsNCiAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRjLT5JRF0gPSAkYzsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5jYXRlZ29yaWVzIGFzICRpZCA9PiAkYykgew0KICAgICAgICAgICAgJGwgPSAnbHYnIC4gJGMtPkxldmVsOw0KICAgICAgICAgICAgJHskbH1bJGMtPlBhcmVudElEXVtdID0gJGlkOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFpc19hcnJheSgkbHYwWzBdKSkgew0KICAgICAgICAgICAgJGx2MFswXSA9IGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAvKg0KICAgICAgICAgKiDku6XkuIvlnoPlnL7ku6PnoIHvvIzlv4Xpobvph43mnoTvvIENCiAgICAgICAgICovDQogICAgICAgIGZvcmVhY2ggKCRsdjBbMF0gYXMgJGlkMCkgew0KICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNieW9yZGVyWyRpZDBdID0gJiR0aGlzLT5jYXRlZ29yaWVzWyRpZDBdOw0KICAgICAgICAgICAgaWYgKCFpc3NldCgkbHYxWyRpZDBdKSkgew0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yZWFjaCAoJGx2MVskaWQwXSBhcyAkaWQxKSB7DQogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5jYXRlZ29yaWVzWyRpZDFdLT5QYXJlbnRJRCA9PSAkaWQwKSB7DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDFdLT5Sb290SUQgPSAkaWQwOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQwXS0+U3ViQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV07DQogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDBdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICR0aGlzLT5jYXRlZ29yaWVzWyRpZDFdOw0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc2J5b3JkZXJbJGlkMV0gPSAmJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV07DQogICAgICAgICAgICAgICAgICAgIGlmICghaXNzZXQoJGx2MlskaWQxXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRsdjJbJGlkMV0gYXMgJGlkMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5jYXRlZ29yaWVzWyRpZDJdLT5QYXJlbnRJRCA9PSAkaWQxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMl0tPlJvb3RJRCA9ICRpZDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMF0tPkNoaWxkcmVuQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV0tPlN1YkNhdGVnb3JpZXNbXSA9ICR0aGlzLT5jYXRlZ29yaWVzWyRpZDJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDFdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICR0aGlzLT5jYXRlZ29yaWVzWyRpZDJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlclskaWQyXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc1skaWQyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzc2V0KCRsdjNbJGlkMl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkbHYzWyRpZDJdIGFzICRpZDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5jYXRlZ29yaWVzWyRpZDNdLT5QYXJlbnRJRCA9PSAkaWQyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQzXS0+Um9vdElEID0gJGlkMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzWyRpZDBdLT5DaGlsZHJlbkNhdGVnb3JpZXNbXSA9ICR0aGlzLT5jYXRlZ29yaWVzWyRpZDNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNhdGVnb3JpZXNbJGlkMV0tPkNoaWxkcmVuQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQyXS0+U3ViQ2F0ZWdvcmllc1tdID0gJHRoaXMtPmNhdGVnb3JpZXNbJGlkM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y2F0ZWdvcmllc1skaWQyXS0+Q2hpbGRyZW5DYXRlZ29yaWVzW10gPSAkdGhpcy0+Y2F0ZWdvcmllc1skaWQzXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jYXRlZ29yaWVzYnlvcmRlclskaWQzXSA9ICYkdGhpcy0+Y2F0ZWdvcmllc1skaWQzXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeagh+etvuWIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkVGFncygpDQogICAgew0KICAgICAgICAkdGhpcy0+dGFncyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT50YWdzYnluYW1lID0gYXJyYXkoKTsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPkdldFRhZ0xpc3QoKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR0KSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc1skdC0+SURdID0gJHQ7DQogICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZVskdC0+TmFtZV0gPSAmJHRoaXMtPnRhZ3NbJHQtPklEXTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOi9veWFpeaooeWdl+WIl+ihqC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBMb2FkTW9kdWxlcygpDQogICAgew0KICAgICAgICAkdGhpcy0+bW9kdWxlcyA9IGFycmF5KCk7DQogICAgICAgICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZSA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRNb2R1bGVMaXN0KCk7DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkbSkgew0KICAgICAgICAgICAgJHRoaXMtPm1vZHVsZXNbXSA9ICRtOw0KICAgICAgICAgICAgJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyRtLT5GaWxlTmFtZV0gPSAkbTsNCiAgICAgICAgfQ0KDQogICAgICAgICRkaXIgPSAkdGhpcy0+dXNlcnNkaXIgLiAndGhlbWUvJyAuICR0aGlzLT50aGVtZSAuICcvaW5jbHVkZS8nOw0KICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGRpcikpIHsNCiAgICAgICAgICAgICRmaWxlcyA9IEdldEZpbGVzSW5EaXIoJGRpciwgJ3BocCcpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGZpbGVzIGFzICRzb3J0bmFtZSA9PiAkZnVsbG5hbWUpIHsNCiAgICAgICAgICAgICAgICAkbSA9IG5ldyBNb2R1bGUoKTsNCiAgICAgICAgICAgICAgICAkbS0+RmlsZU5hbWUgPSAkc29ydG5hbWU7DQogICAgICAgICAgICAgICAgJG0tPkNvbnRlbnQgPSBmaWxlX2dldF9jb250ZW50cygkZnVsbG5hbWUpOw0KICAgICAgICAgICAgICAgIGlmICggc3RyaXBvcygkbS0+Q29udGVudCwnPGxpJykgIT09IGZhbHNlICYmIHN0cmlwb3MoJG0tPkNvbnRlbnQsJzwvbGk+JykgIT09IGZhbHNlICkgew0KICAgICAgICAgICAgICAgICAgICAkbS0+VHlwZSA9ICd1bCc7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgJG0tPlR5cGUgPSAnZGl2JzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJG0tPlNvdXJjZSA9ICd0aGVtZSc7DQogICAgICAgICAgICAgICAgJHRoaXMtPm1vZHVsZXNbXSA9ICRtOw0KICAgICAgICAgICAgICAgICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVskbS0+RmlsZU5hbWVdID0gJG07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXkuLvpopjliJfooaguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEFwcFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUaGVtZXMoKQ0KICAgIHsNCiAgICAgICAgJGFsbFRoZW1lcyA9IGFycmF5KCk7DQogICAgICAgICRkaXJzID0gR2V0RGlyc0luRGlyKCR0aGlzLT51c2Vyc2RpciAuICd0aGVtZS8nKTsNCiAgICAgICAgbmF0Y2FzZXNvcnQoJGRpcnMpOw0KICAgICAgICBhcnJheV91bnNoaWZ0KCRkaXJzLCAkdGhpcy0+dGhlbWUpOw0KICAgICAgICAkZGlycyA9IGFycmF5X3VuaXF1ZSgkZGlycyk7DQogICAgICAgIGZvcmVhY2ggKCRkaXJzIGFzICRpZCkgew0KICAgICAgICAgICAgJGFwcCA9IG5ldyBBcHAoKTsNCiAgICAgICAgICAgIGlmICgkYXBwLT5Mb2FkSW5mb0J5WG1sKCd0aGVtZScsICRpZCkgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICRhbGxUaGVtZXNbXSA9ICRhcHA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFsbFRoZW1lczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXmj5Lku7bliJfooaguDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEFwcFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRQbHVnaW5zKCkNCiAgICB7DQogICAgICAgICRhbGxQbHVnaW5zID0gYXJyYXkoKTsNCiAgICAgICAgJGRpcnMgPSBHZXREaXJzSW5EaXIoJHRoaXMtPnVzZXJzZGlyIC4gJ3BsdWdpbi8nKTsNCiAgICAgICAgbmF0Y2FzZXNvcnQoJGRpcnMpOw0KDQogICAgICAgIGZvcmVhY2ggKCRkaXJzIGFzICRpZCkgew0KICAgICAgICAgICAgJGFwcCA9IG5ldyBBcHAoKTsNCiAgICAgICAgICAgIGlmICgkYXBwLT5Mb2FkSW5mb0J5WG1sKCdwbHVnaW4nLCAkaWQpID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkYWxsUGx1Z2luc1tdID0gJGFwcDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYWxsUGx1Z2luczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDovb3lhaXmjIflrprlupTnlKguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlIOW6lOeUqOexu+Weiyh0aGVtZXxwbHVnaW4pDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICDlupTnlKhJRA0KICAgICAqDQogICAgICogQHJldHVybiBBcHANCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZEFwcCgkdHlwZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgJGFwcCA9IG5ldyBBcHAoKTsNCiAgICAgICAgaWYgKCRhcHAtPkxvYWRJbmZvQnlYbWwoJHR5cGUsICRpZCkgIT0gdHJ1ZSkgew0KICAgICAgICAgICAgJGFwcC0+aXNsb2FkZWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkYXBwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeW6lOeUqOaYr+WQpuWuieijheW5tuWQr+eUqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUg5bqU55So77yI5o+S5Lu25oiW5Li76aKY77yJ55qESUQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1BsdWdpbigkbmFtZSkNCiAgICB7DQogICAgICAgIHJldHVybiBpbl9hcnJheSgkbmFtZSwgJHRoaXMtPmFjdGl2ZWRhcHBzKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XlupTnlKjmmK/lkKblronoo4XlubblkK/nlKguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lIOW6lOeUqElE77yI5o+S5Lu25oiW5Li76aKY77yJDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tBcHAoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkNoZWNrUGx1Z2luKCRuYW1lKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5bpooTmv4DmtLvmj5Lku7blkI3mlbDnu4QuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZ1tdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFByZUFjdGl2ZVBsdWdpbigpDQogICAgew0KICAgICAgICAkYXAgPSBleHBsb2RlKCJ8IiwgJHRoaXMtPm9wdGlvblsnWkNfVVNJTkdfUExVR0lOX0xJU1QnXSk7DQogICAgICAgICRhcCA9IGFycmF5X3VuaXF1ZSgkYXApOw0KDQogICAgICAgIHJldHVybiAkYXA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6L295YWl5oyH5a6a5bqU55So6K+t6KiA5YyFLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZSAgICDlupTnlKjnsbvlnosoc3lzdGVtfHRoZW1lfHBsdWdpbikNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCAgICAgIOW6lOeUqElEDQogICAgICogQHBhcmFtIHN0cmluZyAkZGVmYXVsdCDpu5jorqTor63oqIANCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG51bGwNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZExhbmd1YWdlKCR0eXBlLCAkaWQsICRkZWZhdWx0ID0gJycpDQogICAgew0KICAgICAgICAkbGFuZ3VhZ2VQYXRoID0gJHRoaXMtPnBhdGg7DQogICAgICAgICRsYW5ndWFnZVJlZ0V4ID0gJy9eKFswLTlBLVpcLV9dKilcLnBocCQvdWknOw0KICAgICAgICAkbGFuZ3VhZ2VMaXN0ID0gYXJyYXkoKTsNCiAgICAgICAgJGxhbmd1YWdlID0gJyc7DQogICAgICAgICRkZWZhdWx0ID0gc3RyX3JlcGxhY2UoYXJyYXkoJy8nLCAnXFwnKSwgJycsICRkZWZhdWx0KTsNCiAgICAgICAgJGxhbmd1YWdlUHRyID0gJiR0aGlzLT5sYW5nOw0KDQogICAgICAgIGlmICgkZGVmYXVsdCA9PT0gJycpIHsNCiAgICAgICAgICAgICRkZWZhdWx0ID0gJHRoaXMtPm9wdGlvblsnWkNfQkxPR19MQU5HVUFHRVBBQ0snXTsNCiAgICAgICAgfQ0KDQogICAgICAgICRkZWZhdWx0TGFuZ3VhZ2VMaXN0ID0gYXJyYXkoJGRlZmF1bHQsICd6aC1jbicsICd6aC10dycsICdlbicpOw0KDQogICAgICAgIHN3aXRjaCAoJHR5cGUpIHsNCiAgICAgICAgICAgIGNhc2UgJ3N5c3RlbSc6DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAnemJfdXNlcnMvbGFuZ3VhZ2UvJzsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgJ3BsdWdpbic6DQogICAgICAgICAgICBjYXNlICd0aGVtZSc6DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlUGF0aCAuPSAnemJfdXNlcnMvJyAuICR0eXBlIC4gJy8nIC4gJGlkIC4gJy9sYW5ndWFnZS8nOw0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVB0ciA9ICYkdGhpcy0+bGFuZ1skaWRdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VQYXRoIC49ICR0eXBlIC4gJy9sYW5ndWFnZS8nOw0KICAgICAgICAgICAgICAgICRsYW5ndWFnZVB0ciA9ICYkdGhpcy0+bGFuZ1skaWRdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQoNCiAgICAgICAgJGhhbmRsZSA9IEBvcGVuZGlyKCRsYW5ndWFnZVBhdGgpOw0KICAgICAgICAkbWF0Y2ggPSBudWxsOw0KICAgICAgICBpZiAoJGhhbmRsZSkgew0KICAgICAgICAgICAgd2hpbGUgKGZhbHNlICE9PSAoJGZpbGUgPSByZWFkZGlyKCRoYW5kbGUpKSkgew0KICAgICAgICAgICAgICAgIGlmIChwcmVnX21hdGNoKCRsYW5ndWFnZVJlZ0V4LCAkZmlsZSwgJG1hdGNoKSkgew0KICAgICAgICAgICAgICAgICAgICAkbGFuZ3VhZ2VMaXN0W10gPSAkbWF0Y2hbMV07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2xvc2VkaXIoJGhhbmRsZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyDov5nph4zkuI3kvJrmiafooYzliLDvvIzlnKhvcGVuZGly5pe25bCx5bey57uP5oqb5Ye6RV9XQVJOSU5HDQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdDYW5ub3Qgb3BlbmRpcignIC4gJGxhbmd1YWdlUGF0aCAuICcpJyk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJGxhbmd1YWdlTGlzdCkgPT09IDApIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ05vIGxhbmd1YWdlIGluICcgLiAkbGFuZ3VhZ2VQYXRoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8IGNvdW50KCRkZWZhdWx0TGFuZ3VhZ2VMaXN0KTsgJGkrKykgew0KICAgICAgICAgICAgLy8g5Zyo5pWI546H5LiK77yMYXJyYXlfc2VhcmNo5ZKM5ZG95ZCN5pWw57uE5rKh5pyJ5pys6LSo5Yy65Yir77yM6Iez5bCR5Zyo6L+Z6YeM5aaC5q2k44CCDQogICAgICAgICAgICBpZiAoZmFsc2UgIT09IGFycmF5X3NlYXJjaCgkZGVmYXVsdExhbmd1YWdlTGlzdFskaV0sICRsYW5ndWFnZUxpc3QpKSB7DQogICAgICAgICAgICAgICAgJGxhbmd1YWdlID0gJGRlZmF1bHRMYW5ndWFnZUxpc3RbJGldOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICgkbGFuZ3VhZ2UgPT09ICcnKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdMYW5ndWFnZSAnIC4gJGRlZmF1bHQgLiAnIGlzIG5vdCBmb3VuZCBpbiAnIC4gJGxhbmd1YWdlUGF0aCk7DQogICAgICAgIH0NCg0KICAgICAgICAkbGFuZ3VhZ2VQYXRoIC49ICRsYW5ndWFnZSAuICcucGhwJzsNCiAgICAgICAgJGxhbmd1YWdlUHRyID0gcmVxdWlyZSAkbGFuZ3VhZ2VQYXRoOw0KICAgICAgICAkdGhpcy0+bGFuZ3BhY2tsaXN0W10gPSBhcnJheSgkdHlwZSwgJGlkLCAkbGFuZ3VhZ2UpOw0KICAgICAgICBpZiAoJHR5cGUgPT0gJ3N5c3RlbScpIHsNCiAgICAgICAgICAgICR0aGlzLT5sYW5nWydlcnJvciddWyc3NyddID0gc3RyX3JlcGxhY2UoYXJyYXkoJyVtaW4nLCAnJW1heCcpLCBhcnJheSgkdGhpcy0+b3B0aW9uWydaQ19VU0VSTkFNRV9NSU4nXSwgJHRoaXMtPm9wdGlvblsnWkNfVVNFUk5BTUVfTUFYJ10pLCAkdGhpcy0+bGFuZ1snZXJyb3InXVsnNzcnXSk7DQogICAgICAgICAgICAkdGhpcy0+bGFuZ3MgPSBqc29uX2RlY29kZShqc29uX2VuY29kZSgkdGhpcy0+bGFuZykpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKCRpZCAhPSAnJyAmJiBpc3NldCgkdGhpcy0+bGFuZ1skaWRdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5sYW5ncy0+JGlkID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmdbJGlkXSkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZmx1c2hMYW5ndWFnZXMoKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmxhbmdzID0ganNvbl9kZWNvZGUoanNvbl9lbmNvZGUoJHRoaXMtPmxhbmcpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDph43mlrDor7vlj5bor63oqIDljIUuDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWxvYWRMYW5ndWFnZXMoKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gJHRoaXMtPmxhbmdwYWNrbGlzdDsNCiAgICAgICAgJHRoaXMtPmxhbmcgPSAkdGhpcy0+bGFuZ3BhY2tsaXN0ID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR2KSB7DQogICAgICAgICAgICAkdGhpcy0+TG9hZExhbmd1YWdlKCR2WzBdLCAkdlsxXSwgJHZbMl0pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yib5bu65qih5p2/5a+56LGh77yM6aKE5Yqg6L295bey57yW6K+R5qih5p2/DQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0aGVtZSDmjIflrprkuLvpopjlkI0NCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGVtcGxhdGUNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUHJlcGFyZVRlbXBsYXRlKCR0aGVtZSA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoaXNfbnVsbCgkdGhlbWUpKSB7DQogICAgICAgICAgICAkdGhlbWUgPSAmJHRoaXMtPnRoZW1lOw0KICAgICAgICB9DQoNCiAgICAgICAgJHRlbXBsYXRlID0gbmV3IFRlbXBsYXRlKCk7DQogICAgICAgICR0ZW1wbGF0ZS0+TWFrZVRlbXBsYXRlVGFncygpOw0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9NYWtlVGVtcGxhdGV0YWdzJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICAkZnBuYW1lKCR0ZW1wbGF0ZS0+dGVtcGxhdGVUYWdzKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0ZW1wbGF0ZS0+U2V0UGF0aCgkdGhpcy0+dXNlcnNkaXIgLiAnY2FjaGUvY29tcGlsZWQvJyAuICR0aGVtZSAuICcvJyk7DQogICAgICAgICR0ZW1wbGF0ZS0+dGhlbWUgPSAkdGhlbWU7DQoNCiAgICAgICAgcmV0dXJuICR0ZW1wbGF0ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmqKHmnb/op6PmnpAuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQnVpbGRUZW1wbGF0ZSgpDQogICAgew0KICAgICAgICAkdGhpcy0+dGVtcGxhdGUtPkxvYWRUZW1wbGF0ZXMoKTsNCg0KICAgICAgICBmb3JlYWNoICgkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9aYnBfQnVpbGRUZW1wbGF0ZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgkdGhpcy0+dGVtcGxhdGUtPnRlbXBsYXRlcyk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHRoaXMtPnRlbXBsYXRlLT5CdWlsZFRlbXBsYXRlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5pu05paw5qih5p2/57yT5a2YLg0KICAgICAqDQogICAgICogQHBhcmFtIGJvb2wgJG9ubHljaGVjayAg5Li655yf55qE6K+d77yM5Y+q5Yik5pat5piv5ZCm6ZyA6KaB6ICM5LiNQnVpbGQNCiAgICAgKiBAcGFyYW0gYm9vbCAkZm9yY2VidWlsZA0KICAgICAqDQogICAgICogQHJldHVybiB0cnVlIG9yIGZhbHNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrVGVtcGxhdGUoJG9ubHljaGVjayA9IGZhbHNlLCAkZm9yY2VidWlsZCA9IGZhbHNlKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPnRlbXBsYXRlLT5Mb2FkVGVtcGxhdGVzKCk7DQogICAgICAgICRzID0gaW1wbG9kZSgkdGhpcy0+dGVtcGxhdGUtPnRlbXBsYXRlcyk7DQogICAgICAgICRtZDUgPSBtZDUoJHMpOw0KDQogICAgICAgIC8v5pys5Ye95pWw55qE6L+U5Zue5YC85b6I5pyJ5oSP5oCd77yM5Li6ZmFsc2XooajnpLrpnIDopoFyZWJ1aWxkIOS4unRydWXooajnpLrlt7Lph43lu7rlrozmiJDmiJbmmK/kuI3pnIDopoFyZWJ1aWxkDQogICAgICAgIC8vJHpicC0+Q2hlY2tUZW1wbGF0ZSh0cnVlKSA9PSBmYWxzZSDnmoTmhI/mgJ3vvIzlsLHmmK/liKTmlq3mqKHmnb/pnIDpnIDopoHph43liLfmlrDlkJfvvJ8NCg0KICAgICAgICAvL+WmguaenOWvueavlOS4jeS4gOagtywkb25seWNoZWNr5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ICE9ICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSkgew0KICAgICAgICAgICAgaWYgKCRvbmx5Y2hlY2sgPT0gdHJ1ZSAmJiAkZm9yY2VidWlsZCA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5CdWlsZFRlbXBsYXRlKCk7DQogICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPnRlbXBsYXRlc19tZDUgPSAkbWQ1Ow0KICAgICAgICAgICAgJHRoaXMtPlNhdmVDYWNoZSgpOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICAvL+WmguaenOWvueavlOS4gOagt+eahOivne+8jCRmb3JjZWJ1aWxk5bCx5pyJ55So5LqGDQogICAgICAgIGlmICgkbWQ1ID09ICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSkgew0KICAgICAgICAgICAgaWYgKCRmb3JjZWJ1aWxkID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+QnVpbGRUZW1wbGF0ZSgpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5jYWNoZS0+dGVtcGxhdGVzX21kNSA9ICRtZDU7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNhdmVDYWNoZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog55Sf5oiQ5omA5pyJ6L+bUmVhZHkgTGlzdOeahOaooeWdl+eahENvbnRlbnTlhoXlrrnlubbkv53lrZguDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEJ1aWxkTW9kdWxlKCkNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9CdWlsZE1vZHVsZSddIGFzICRmcG5hbWUgPT4gJiRmcHNpZ25hbCkgew0KICAgICAgICAgICAgJGZwbmFtZSgpOw0KICAgICAgICB9DQogICAgICAgIE1vZHVsZUJ1aWxkZXI6OkJ1aWxkKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN5bu65qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRnVuY3Rpb24g55So5oi35Ye95pWwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0J1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSwgJG1vZHVsZUZ1bmN0aW9uKQ0KICAgIHsNCiAgICAgICAgTW9kdWxlQnVpbGRlcjo6UmVnKCRtb2R1bGVGaWxlTmFtZSwgJG1vZHVsZUZ1bmN0aW9uKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDns7vnu5/pu5jorqTms6jlhozmqKHlnZcuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZ0J1aWxkTW9kdWxlcygpDQogICAgew0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NhdGFsb2cnLCAnTW9kdWxlQnVpbGRlcjo6Q2F0YWxvZycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2NhbGVuZGFyJywgJ01vZHVsZUJ1aWxkZXI6OkNhbGVuZGFyJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgnY29tbWVudHMnLCAnTW9kdWxlQnVpbGRlcjo6Q29tbWVudHMnKTsNCiAgICAgICAgJHRoaXMtPlJlZ0J1aWxkTW9kdWxlKCdwcmV2aW91cycsICdNb2R1bGVCdWlsZGVyOjpMYXRlc3RBcnRpY2xlcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2FyY2hpdmVzJywgJ01vZHVsZUJ1aWxkZXI6OkFyY2hpdmVzJyk7DQogICAgICAgICR0aGlzLT5SZWdCdWlsZE1vZHVsZSgnbmF2YmFyJywgJ01vZHVsZUJ1aWxkZXI6Ok5hdmJhcicpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ3RhZ3MnLCAnTW9kdWxlQnVpbGRlcjo6VGFnTGlzdCcpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ3N0YXRpc3RpY3MnLCAnTW9kdWxlQnVpbGRlcjo6U3RhdGlzdGljcycpOw0KICAgICAgICAkdGhpcy0+UmVnQnVpbGRNb2R1bGUoJ2F1dGhvcnMnLCAnTW9kdWxlQnVpbGRlcjo6QXV0aG9ycycpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOa3u+WKoOi/m+WFpUJ1aWxkIFJlYWR55YiX6KGo55qE5qih5Z2XLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbW9kdWxlRmlsZU5hbWUg5qih5Z2X5ZCNDQogICAgICogQHBhcmFtIG51bGwgICAkcGFyYW1ldGVycyAgICAg5qih5Z2X5Y+C5pWwDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEFkZEJ1aWxkTW9kdWxlKCRtb2R1bGVGaWxlTmFtZSwgJHBhcmFtZXRlcnMgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHAgPSBmdW5jX2dldF9hcmdzKCk7DQogICAgICAgIGNhbGxfdXNlcl9mdW5jX2FycmF5KCdNb2R1bGVCdWlsZGVyOjpBZGQnLCAkcCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk6L+b5YWlQnVpbGQgUmVhZHnliJfooajmqKHlnZcuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRtb2R1bGVGaWxlTmFtZSDmqKHlnZflkI0NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsQnVpbGRNb2R1bGUoJG1vZHVsZUZpbGVOYW1lKQ0KICAgIHsNCiAgICAgICAgTW9kdWxlQnVpbGRlcjo6RGVsKCRtb2R1bGVGaWxlTmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+i5oyH5a6a5pWw5o2u57uT5p6E55qEc3Fs5bm26L+U5ZueQmFzZeWvueixoeWIl+ihqC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmd8YXJyYXkgJHRhYmxlICAgIOaVsOaNruihqA0KICAgICAqIEBwYXJhbSBhcnJheSAgICAgICAgJGRhdGFpbmZvIOaVsOaNruWtl+autQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgJHNxbCAgICAgIFNRTOaTjeS9nOivreWPpQ0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRMaXN0Q3VzdG9tKCR0YWJsZSwgJGRhdGFpbmZvLCAkc3FsKQ0KICAgIHsNCiAgICAgICAgJGFycmF5ID0gbnVsbDsNCiAgICAgICAgJGxpc3QgPSBhcnJheSgpOw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+ZGItPlF1ZXJ5KCRzcWwpOw0KICAgICAgICBpZiAoIWlzc2V0KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJGwgPSBuZXcgQmFzZSgkdGFibGUsICRkYXRhaW5mbyk7DQogICAgICAgICAgICAkbC0+TG9hZEluZm9CeUFzc29jKCRhKTsNCiAgICAgICAgICAgICRsaXN0W10gPSAkbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkbGlzdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmn6Xor6JJROaVsOaNrueahOaMh+WumuaVsOaNrue7k+aehOeahHNxbOW5tui/lOWbnkJhc2Xlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nfGFycmF5ICR0YWJsZSAgICDmlbDmja7ooagNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRkYXRhaW5mbyDmlbDmja7lrZfmrrUNCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICRhcnJheSAgICBJROaVsOe7hA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdEN1c3RvbUJ5QXJyYXkoJHRhYmxlLCAkZGF0YWluZm8sICRhcnJheSkNCiAgICB7DQogICAgICAgIGlmICghaXNfYXJyYXkoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJGFycmF5KSA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgICR3aGVyZVtdID0gYXJyYXkoJ0lOJywgJGRhdGFpbmZvWydJRCddWzBdLCBpbXBsb2RlKCcsJywgJGFycmF5KSk7DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0YWJsZSwgJyonLCAkd2hlcmUpOw0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkbCA9IG5ldyBCYXNlKCR0YWJsZSwgJGRhdGFpbmZvKTsNCiAgICAgICAgICAgICRsLT5Mb2FkSW5mb0J5QXNzb2MoJGEpOw0KICAgICAgICAgICAgJGxpc3RbXSA9ICRsOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRsaXN0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOW3suaUueWQjUdldExpc3RUeXBlLDEuNeeJiOS4reaJlOaOieacieatp+S5ieeahEdldExpc3QuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHR5cGUNCiAgICAgKiBAcGFyYW0gJHNxbA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdFR5cGUoJHR5cGUsICRzcWwpDQogICAgew0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAvKiogQHZhciBCYXNlICRsICovDQogICAgICAgICAgICAkbCA9IG5ldyAkdHlwZSgpOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0TGlzdE9yaWdpbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkc3FsDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRMaXN0T3JpZ2luKCRzcWwpDQogICAgew0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkbGlzdFtdID0gJGE7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5p+l6K+iSUTmlbDmja7nmoTmjIflrprnsbvlnovnmoRzcWzlubbov5Tlm57mjIflrprnsbvlnovlr7nosaHliJfooaguDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0eXBlICDnsbvlnosNCiAgICAgKiBAcGFyYW0gbWl4ZWQgICRhcnJheSBJROaVsOe7hA0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TGlzdFR5cGVCeUFycmF5KCR0eXBlLCAkYXJyYXkpDQogICAgew0KICAgICAgICBpZiAoIWlzX2FycmF5KCRhcnJheSkpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkd2hlcmUgPSBhcnJheSgpOw0KICAgICAgICAkd2hlcmVbXSA9IGFycmF5KCdJTicsICR0aGlzLT5kYXRhaW5mb1skdHlwZV1bJ0lEJ11bMF0sIGltcGxvZGUoJywnLCAkYXJyYXkpKTsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWyR0eXBlXSwgJyonLCAkd2hlcmUpOw0KICAgICAgICAkYXJyYXkgPSBudWxsOw0KICAgICAgICAkbGlzdCA9IGFycmF5KCk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgICAgIGlmICghaXNzZXQoJGFycmF5KSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAvKiogQHZhciBCYXNlICRsICovDQogICAgICAgICAgICAkbCA9IG5ldyAkdHlwZSgpOw0KICAgICAgICAgICAgJGwtPkxvYWRJbmZvQnlBc3NvYygkYSk7DQogICAgICAgICAgICAkbGlzdFtdID0gJGw7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGxpc3Q7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCRzZWxlY3QpKSB7DQogICAgICAgICAgICAkc2VsZWN0ID0gYXJyYXkoJyonKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZW1wdHkoJHdoZXJlKSkgew0KICAgICAgICAgICAgJHdoZXJlID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1Bvc3QnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQoNCiAgICAgICAgLyoqIEB2YXIgUG9zdFtdICRhcnJheSAqLw0KICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ1Bvc3QnLCAkc3FsKTsNCiAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRhKSB7DQogICAgICAgICAgICAkdGhpcy0+cG9zdHNbJGEtPklEXSA9ICRhOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRhcnJheTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROaVsOe7hOiOt+WPluaWh+eroOWunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBtaXhlZFtdICRhcnJheQ0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W118QmFzZVtdIFBvc3RzDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RCeUFycmF5KCRhcnJheSkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0TGlzdFR5cGVCeUFycmF5KCdQb3N0JywgJGFycmF5KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICogQHBhcmFtIG1peGVkICRyZWFkdGFncw0KICAgICAqDQogICAgICogQHJldHVybiBQb3N0W10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0QXJ0aWNsZUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsLCAkcmVhZHRhZ3MgPSB0cnVlKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCRzZWxlY3QpKSB7DQogICAgICAgICAgICAkc2VsZWN0ID0gYXJyYXkoJyonKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZW1wdHkoJHdoZXJlKSkgew0KICAgICAgICAgICAgJHdoZXJlID0gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc19hcnJheSgkd2hlcmUpKSB7DQogICAgICAgICAgICAkaGFzVHlwZSA9IGZhbHNlOw0KICAgICAgICAgICAgZm9yZWFjaCAoJHdoZXJlIGFzICRrZXkgPT4gJHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHZhbHVlIGFzICRrZXkyID0+ICR2YWx1ZTIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgka2V5MiA9PSAxICYmICR2YWx1ZTIgPT0gJ2xvZ19UeXBlJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRoYXNUeXBlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghJGhhc1R5cGUpIHsNCiAgICAgICAgICAgICAgICBhcnJheV91bnNoaWZ0KCR3aGVyZSwgYXJyYXkoJz0nLCAnbG9nX1R5cGUnLCAnMCcpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnUG9zdCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCg0KICAgICAgICAvKiogQHZhciBQb3N0W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnUG9zdCcsICRzcWwpOw0KDQogICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgJHRoaXMtPnBvc3RzWyRhLT5JRF0gPSAkYTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkcmVhZHRhZ3MpIHsNCiAgICAgICAgICAgICR0YWdzdHJpbmcgPSAnJzsNCiAgICAgICAgICAgIGZvcmVhY2ggKCRhcnJheSBhcyAkYSkgew0KICAgICAgICAgICAgICAgICR0YWdzdHJpbmcgLj0gJGEtPlRhZzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICR0aGlzLT5Mb2FkVGFnc0J5SURTdHJpbmcoJHRhZ3N0cmluZyk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBhZ2VMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGVtcHR5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgICR3aGVyZSA9IGFycmF5KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGlzX2FycmF5KCR3aGVyZSkpIHsNCiAgICAgICAgICAgIGFycmF5X3Vuc2hpZnQoJHdoZXJlLCBhcnJheSgnPScsICdsb2dfVHlwZScsICcxJykpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydQb3N0J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICAvKiogQHZhciBQb3N0W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnUG9zdCcsICRzcWwpOw0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgICR0aGlzLT5wb3N0c1skYS0+SURdID0gJGE7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ29tbWVudFtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENvbW1lbnRMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydDb21tZW50J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KICAgICAgICAvKiogQHZhciBDb21tZW50W10gJGFycmF5ICovDQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnQ29tbWVudCcsICRzcWwpOw0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGNvbW1lbnQpIHsNCiAgICAgICAgICAgICR0aGlzLT5jb21tZW50c1skY29tbWVudC0+SURdID0gJGNvbW1lbnQ7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGFycmF5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCRzZWxlY3QpKSB7DQogICAgICAgICAgICAkc2VsZWN0ID0gYXJyYXkoJyonKTsNCiAgICAgICAgfQ0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ01lbWJlciddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCg0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldExpc3RUeXBlKCdNZW1iZXInLCAkc3FsKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHNlbGVjdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkd2hlcmUNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9yZGVyDQogICAgICogQHBhcmFtIG1peGVkICRsaW1pdA0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3B0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIFRhZ1tdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdMaXN0KCRzZWxlY3QgPSBudWxsLCAkd2hlcmUgPSBudWxsLCAkb3JkZXIgPSBudWxsLCAkbGltaXQgPSBudWxsLCAkb3B0aW9uID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmIChlbXB0eSgkc2VsZWN0KSkgew0KICAgICAgICAgICAgJHNlbGVjdCA9IGFycmF5KCcqJyk7DQogICAgICAgIH0NCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydUYWcnXSwgJHNlbGVjdCwgJHdoZXJlLCAkb3JkZXIsICRsaW1pdCwgJG9wdGlvbik7DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRMaXN0VHlwZSgnVGFnJywgJHNxbCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBDYXRlZ29yeVtdfEJhc2VbXQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRDYXRlZ29yeUxpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCRzZWxlY3QpKSB7DQogICAgICAgICAgICAkc2VsZWN0ID0gYXJyYXkoJyonKTsNCiAgICAgICAgfQ0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ0NhdGVnb3J5J10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KDQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0TGlzdFR5cGUoJ0NhdGVnb3J5JywgJHNxbCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQHBhcmFtIG1peGVkICRzZWxlY3QNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJHdoZXJlDQogICAgICogQHBhcmFtIG1peGVkICRvcmRlcg0KICAgICAqIEBwYXJhbSBtaXhlZCAkbGltaXQNCiAgICAgKiBAcGFyYW0gbWl4ZWQgJG9wdGlvbg0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGVbXXxCYXNlW10NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TW9kdWxlTGlzdCgkc2VsZWN0ID0gbnVsbCwgJHdoZXJlID0gbnVsbCwgJG9yZGVyID0gbnVsbCwgJGxpbWl0ID0gbnVsbCwgJG9wdGlvbiA9IG51bGwpDQogICAgew0KICAgICAgICBpZiAoZW1wdHkoJHNlbGVjdCkpIHsNCiAgICAgICAgICAgICRzZWxlY3QgPSBhcnJheSgnKicpOw0KICAgICAgICB9DQogICAgICAgICRzcWwgPSAkdGhpcy0+ZGItPnNxbC0+U2VsZWN0KCR0aGlzLT50YWJsZVsnTW9kdWxlJ10sICRzZWxlY3QsICR3aGVyZSwgJG9yZGVyLCAkbGltaXQsICRvcHRpb24pOw0KDQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0TGlzdFR5cGUoJ01vZHVsZScsICRzcWwpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBtaXhlZCAkc2VsZWN0DQogICAgICogQHBhcmFtIG1peGVkICR3aGVyZQ0KICAgICAqIEBwYXJhbSBtaXhlZCAkb3JkZXINCiAgICAgKiBAcGFyYW0gbWl4ZWQgJGxpbWl0DQogICAgICogQHBhcmFtIG1peGVkICRvcHRpb24NCiAgICAgKg0KICAgICAqIEByZXR1cm4gVXBsb2FkW118QmFzZVtdDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFVwbG9hZExpc3QoJHNlbGVjdCA9IG51bGwsICR3aGVyZSA9IG51bGwsICRvcmRlciA9IG51bGwsICRsaW1pdCA9IG51bGwsICRvcHRpb24gPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKGVtcHR5KCRzZWxlY3QpKSB7DQogICAgICAgICAgICAkc2VsZWN0ID0gYXJyYXkoJyonKTsNCiAgICAgICAgfQ0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPlNlbGVjdCgkdGhpcy0+dGFibGVbJ1VwbG9hZCddLCAkc2VsZWN0LCAkd2hlcmUsICRvcmRlciwgJGxpbWl0LCAkb3B0aW9uKTsNCg0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldExpc3RUeXBlKCdVcGxvYWQnLCAkc3FsKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gJHNxbA0KICAgICAqDQogICAgICogQHJldHVybiBtaXhlZA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBnZXRfcmVzdWx0cygkc3FsKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5kYi0+UXVlcnkoJHNxbCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qC55o2u5Yir5ZCN5b6X5Yiw55u45bqU5pWw5o2uLg0KICAgICAqDQogICAgICogQHBhcmFtIEJhc2VbXXxzdHJpbmcgJiRvYmplY3QgICDnvJPlrZjlr7nosaENCiAgICAgKiBAcGFyYW0gc3RyaW5nICAgICAgICAkdmFsDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJGJhY2tBdHRyDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJGNsYXNzTmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBCYXNlfG51bGwNCiAgICAgKi8NCiAgICBwcml2YXRlIGZ1bmN0aW9uIEdldFNvbWVUaGluZ0J5QWxpYXMoJG9iamVjdCwgJHZhbCwgJGJhY2tBdHRyID0gbnVsbCwgJGNsYXNzTmFtZSA9IG51bGwpDQogICAgew0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygkb2JqZWN0LCAnQWxpYXMnLCAkdmFsKTsNCg0KICAgICAgICBpZiAoIWlzX251bGwoJHJldCkpIHsNCiAgICAgICAgICAgIHJldHVybiAkcmV0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKGlzX251bGwoJGJhY2tBdHRyKSkgew0KICAgICAgICAgICAgICAgICRiYWNrQXR0ciA9ICR0aGlzLT5vcHRpb25bJ1pDX0FMSUFTX0JBQ0tfQVRUUiddOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygkb2JqZWN0LCAkYmFja0F0dHIsICR2YWwsICRjbGFzc05hbWUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qC55o2uSUTlvpfliLDnm7jlupTmlbDmja4uDQogICAgICoNCiAgICAgKiBAcGFyYW0gQmFzZVtdICAgICAmJG9iamVjdCAgIOe8k+WtmOWvueixoQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICRjbGFzc05hbWUg5om+5LiN5YiwSUTml7bliJ3lp4vljJblr7nosaHnmoTnsbvlkI0NCiAgICAgKiBAcGFyYW0gaW50fHN0cmluZyAkaWQgICAgICAgIOS4juatpOexu+ebuOWFs+eahElEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2V8bnVsbA0KICAgICAqLw0KICAgIHByaXZhdGUgZnVuY3Rpb24gR2V0U29tZVRoaW5nQnlJZCgmJG9iamVjdCwgJGNsYXNzTmFtZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCRpZCA9PSAwKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRvYmplY3QgIT0gbnVsbCkgew0KICAgICAgICAgICAgLy8kbW9kdWxlc+mdnklE5Li6a2V5DQogICAgICAgICAgICBpZiAoJGNsYXNzTmFtZSA9PSAiTW9kdWxlIikgew0KICAgICAgICAgICAgICAgIGlmICgkaWQgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRvYmplY3QgYXMgJGtleSA9PiAkdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWUtPklEID09ICRpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJG0gPSBuZXcgTW9kdWxlKCk7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChpc3NldCgkb2JqZWN0WyRpZF0pKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICRvYmplY3RbJGlkXTsNCiAgICAgICAgICAgIH0gZWxzZWlmICgkY2xhc3NOYW1lID09ICJQb3N0IiB8fCAkY2xhc3NOYW1lID09ICJDb21tZW50IiB8fCAkY2xhc3NOYW1lID09ICJUYWciKSB7DQogICAgICAgICAgICAgICAgLy8g5paH56ug6ZyA6KaB6K+75Y+W77yM5YW25LuW55qE55u05o6l6L+U5Zue56m65a+56LGh5Y2z5Y+vDQogICAgICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkcCAqLw0KICAgICAgICAgICAgICAgICRwID0gbmV3ICRjbGFzc05hbWUoKTsNCiAgICAgICAgICAgICAgICAkcC0+TG9hZEluZm9CeUlEKCRpZCk7DQogICAgICAgICAgICAgICAgJG9iamVjdFskaWRdID0gJHA7DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJHA7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nQnlBdHRyKCRvYmplY3QsICdJRCcsICRpZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvKiogQHZhciBCYXNlICRwICovDQogICAgICAgICAgICAkcCA9IG5ldyAkY2xhc3NOYW1lKCk7DQogICAgICAgICAgICAkcC0+TG9hZEluZm9CeUlEKCRpZCk7DQoNCiAgICAgICAgICAgIHJldHVybiAkcDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOagueaNruWxnuaAp+WAvOW+l+WIsOebuOW6lOaVsOaNri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW10gJiRvYmplY3Qg57yT5a2Y5a+56LGhDQogICAgICogQHBhcmFtIHN0cmluZyAkYXR0ciAgICDlsZ7mgKflkI0NCiAgICAgKiBAcGFyYW0gbWl4ZWQgICR2YWwgICAgIOimgeafpeaJvueahOWAvA0KICAgICAqDQogICAgICogQHJldHVybiBudWxsDQogICAgICovDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBHZXRTb21lVGhpbmdCeUF0dHIoJiRvYmplY3QsICRhdHRyLCAkdmFsKQ0KICAgIHsNCiAgICAgICAgJHZhbCA9IHRyaW0oJHZhbCk7DQogICAgICAgIGZvcmVhY2ggKCRvYmplY3QgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoaXNfbnVsbCgkdmFsdWUpKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoJHZhbHVlLT4kYXR0ciA9PSAkdmFsKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR2YWx1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluaVsOaNrumAmueUqOWHveaVsC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBCYXNlW118c3RyaW5nICRvYmplY3QgICAg57yT5a2Y5a+56LGh77yIc3RyaW5nIC8gb2JqZWN077yJDQogICAgICogQHBhcmFtIHN0cmluZyAgICAgICAgJGF0dHIgICAgICDmrLLmn6Xmib7nmoTlsZ7mgKcNCiAgICAgKiBAcGFyYW0gbWl4ZWQgICAgICAgICAkdmFsICAgICAgIOimgeafpeaJvuWGheWuuQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgICAgICAgICRjbGFzc05hbWUg5a+56LGh5pyq5om+5Yiw5pe277yM5Yid5aeL5YyW57G75ZCNDQogICAgICoNCiAgICAgKiBAcmV0dXJuIEJhc2V8bnVsbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRTb21lVGhpbmcoJG9iamVjdCwgJGF0dHIsICR2YWwsICRjbGFzc05hbWUgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJGNhY2hlT2JqZWN0ID0gbnVsbDsNCiAgICAgICAgaWYgKGlzX29iamVjdCgkb2JqZWN0KSkgew0KICAgICAgICAgICAgJGNhY2hlT2JqZWN0ID0gJG9iamVjdDsNCiAgICAgICAgfSBlbHNlaWYgKCRvYmplY3QgIT0gIiIpIHsNCiAgICAgICAgICAgICRjYWNoZU9iamVjdCA9ICYkdGhpcy0+JG9iamVjdDsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGF0dHIgPT0gIklEIikgew0KICAgICAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUlkKCRjYWNoZU9iamVjdCwgJGNsYXNzTmFtZSwgJHZhbCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZ0J5QXR0cigkY2FjaGVPYmplY3QsICRhdHRyLCAkdmFsKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHJldCA9PT0gbnVsbCAmJiAhaXNfbnVsbCgkY2xhc3NOYW1lKSkgew0KICAgICAgICAgICAgLyoqIEB2YXIgQmFzZSAkcmV0ICovDQogICAgICAgICAgICAkcmV0ID0gbmV3ICRjbGFzc05hbWUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W5paH56ug5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gUG9zdHxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdwb3N0cycsICdJRCcsICRpZCwgJ1Bvc3QnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4dJROiOt+WPluWIhuexu+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBpbnQgJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdjYXRlZ29yaWVzJywgJ0lEJywgJGlkLCAnQ2F0ZWdvcnknKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fliIbnsbvlkI3ojrflj5bliIbnsbvlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeU5hbWUoJG5hbWUpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnY2F0ZWdvcmllcycsICdOYW1lJywgJG5hbWUsICdDYXRlZ29yeScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+WIhuexu+WIq+WQjeiOt+WPluWIhuexu+WunuS+iy4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKiBAcGFyYW0gbnVsbCAgICRiYWNrS2V5DQogICAgICoNCiAgICAgKiBAcmV0dXJuIENhdGVnb3J5fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUFsaWFzKCRuYW1lLCAkYmFja0tleSA9IG51bGwpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZ0J5QWxpYXMoJ2NhdGVnb3JpZXMnLCAkbmFtZSwgJGJhY2tLZXksICdDYXRlZ29yeScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS4juiAgeeJiOacrOS/neaMgeWFvOWuueWHveaVsC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gQ2F0ZWdvcnkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q2F0ZWdvcnlCeUFsaWFzT3JOYW1lKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRDYXRlZ29yeUJ5QWxpYXMoJG5hbWUsICdOYW1lJyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bmqKHlnZflrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGV8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNb2R1bGVCeUlEKCRpZCkNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdtb2R1bGVzJywgJ0lEJywgJGlkLCAnTW9kdWxlJyk7IC8vIFdoYXQgdGhlIGZ1Y2s/DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HRmlsZU5hbWXojrflj5bmqKHlnZflrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRmbg0KICAgICAqDQogICAgICogQHJldHVybiBNb2R1bGV8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRNb2R1bGVCeUZpbGVOYW1lKCRmbikNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0U29tZVRoaW5nKCdtb2R1bGVzYnlmaWxlbmFtZScsICdGaWxlTmFtZScsICRmbiwgJ01vZHVsZScpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W55So5oi35a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlJRCgkaWQpDQogICAgew0KICAgICAgICAvKiogQHZhciBNZW1iZXIgJHJldCAqLw0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygnbWVtYmVycycsICdJRCcsICRpZCwgJ01lbWJlcicpOw0KICAgICAgICBpZiAoJHJldC0+SUQgPT0gMCkgew0KICAgICAgICAgICAgJHJldC0+R3VpZCA9IEdldEd1aWQoKTsNCiAgICAgICAgICAgIGlmICgkcmV0LT5Mb2FkSW5mb0J5SUQoJGlkKSA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPm1lbWJlcnNbJHJldC0+SURdID0gJHJldDsNCiAgICAgICAgICAgICAgICAkdGhpcy0+bWVtYmVyc2J5bmFtZVskcmV0LT5OYW1lXSA9ICYkdGhpcy0+bWVtYmVyc1skcmV0LT5JRF07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJHJldDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnlKjmiLflkI3ojrflj5bnlKjmiLflrp7kvoso5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJG5hbWUNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0TWVtYmVyQnlOYW1lKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgJG5hbWUgPSB0cmltKCRuYW1lKTsNCiAgICAgICAgaWYgKCEkbmFtZSB8fCAhQ2hlY2tSZWdFeHAoJG5hbWUsICdbdXNlcm5hbWVdJykpIHsNCiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5tZW1iZXJzYnluYW1lWyRuYW1lXTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRhcnJheSA9IGFycmF5X2tleXMoJHRoaXMtPm1lbWJlcnNieW5hbWUpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICRrID0+ICR2KSB7DQogICAgICAgICAgICAgICAgaWYgKHN0cmNhc2VjbXAoJG5hbWUsICR2KSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+bWVtYmVyc2J5bmFtZVskdl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGxpa2UgPSAoJHRoaXMtPmRiLT50eXBlID09ICdwZ3NxbCcpID8gJ0lMSUtFJyA6ICdMSUtFJzsNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJyonLCBhcnJheShhcnJheSgkbGlrZSwgJ21lbV9OYW1lJywgJG5hbWUpKSwgbnVsbCwgMSwgbnVsbCk7DQoNCiAgICAgICAgLyoqIEB2YXIgTWVtYmVyW10gJGFtICovDQogICAgICAgICRhbSA9ICR0aGlzLT5HZXRMaXN0VHlwZSgnTWVtYmVyJywgJHNxbCk7DQogICAgICAgIGlmIChjb3VudCgkYW0pID4gMCkgew0KICAgICAgICAgICAgJG0gPSAkYW1bMF07DQogICAgICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5tZW1iZXJzWyRtLT5JRF0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPm1lbWJlcnNbJG0tPklEXSA9ICRtOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+bWVtYmVyc2J5bmFtZVskbS0+TmFtZV0pKSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPm1lbWJlcnNieW5hbWVbJG0tPk5hbWVdID0gJiR0aGlzLT5tZW1iZXJzWyRtLT5JRF07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiAkbTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBuZXcgTWVtYmVyKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H6I635Y+W55So5oi35ZCN5oiW5Yir5ZCN5a6e5L6LKOS4jeWMuuWIhuWkp+Wwj+WGmSkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIE1lbWJlcnxCYXNlDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckJ5TmFtZU9yQWxpYXMoJG5hbWUpDQogICAgew0KICAgICAgICAkbmFtZSA9IHRyaW0oJG5hbWUpOw0KICAgICAgICBpZiAoISRuYW1lIHx8ICEoQ2hlY2tSZWdFeHAoJG5hbWUsICdbdXNlcm5hbWVdJykgfHwgQ2hlY2tSZWdFeHAoJG5hbWUsICdbbmlja25hbWVdJykpKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPm1lbWJlcnMgYXMgJGtleSA9PiAmJHZhbHVlKSB7DQogICAgICAgICAgICBpZiAoc3RyY2FzZWNtcCgkdmFsdWUtPk5hbWUsICRuYW1lKSA9PSAwIHx8IHN0cmNhc2VjbXAoJHZhbHVlLT5BbGlhcywgJG5hbWUpID09IDApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgJGxpa2UgPSAoJHRoaXMtPmRiLT50eXBlID09ICdwZ3NxbCcpID8gJ0lMSUtFJyA6ICdMSUtFJzsNCg0KICAgICAgICAkc3FsID0gJHRoaXMtPmRiLT5zcWwtPmdldCgpLT5zZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSktPndoZXJlKGFycmF5KCIkbGlrZSBhcnJheSIsIGFycmF5KA0KICAgICAgICAgICAgYXJyYXkoJ21lbV9OYW1lJywgJG5hbWUpLA0KICAgICAgICAgICAgYXJyYXkoJ21lbV9BbGlhcycsICRuYW1lKSwNCiAgICAgICAgKSkpLT5saW1pdCgxKS0+c3FsOw0KDQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+bWVtYmVyc1skbS0+SURdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzWyRtLT5JRF0gPSAkbTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG0tPk5hbWVdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lWyRtLT5OYW1lXSA9ICYkdGhpcy0+bWVtYmVyc1skbS0+SURdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h+mCrueuseWQjeiOt+WPlueUqOaIt+WunuS+iyjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkZW1haWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gTWVtYmVyDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldE1lbWJlckJ5RW1haWwoJGVtYWlsKQ0KICAgIHsNCiAgICAgICAgJGVtYWlsID0gc3RydG9sb3dlcih0cmltKCRlbWFpbCkpOw0KICAgICAgICBpZiAoISRlbWFpbCB8fCAhQ2hlY2tSZWdFeHAoJGVtYWlsLCAnW2VtYWlsXScpKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHNxbCA9ICR0aGlzLT5kYi0+c3FsLT5TZWxlY3QoJHRoaXMtPnRhYmxlWydNZW1iZXInXSwgJyonLCBhcnJheShhcnJheSgnTElLRScsICdtZW1fRW1haWwnLCAkZW1haWwpKSwgbnVsbCwgMSwgbnVsbCk7DQogICAgICAgIC8qKiBAdmFyIE1lbWJlcltdICRhbSAqLw0KICAgICAgICAkYW0gPSAkdGhpcy0+R2V0TGlzdFR5cGUoJ01lbWJlcicsICRzcWwpOw0KICAgICAgICBpZiAoY291bnQoJGFtKSA+IDApIHsNCiAgICAgICAgICAgICRtID0gJGFtWzBdOw0KICAgICAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+bWVtYmVyc1skbS0+SURdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzWyRtLT5JRF0gPSAkbTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPm1lbWJlcnNieW5hbWVbJG0tPk5hbWVdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5tZW1iZXJzYnluYW1lWyRtLT5OYW1lXSA9ICYkdGhpcy0+bWVtYmVyc1skbS0+SURdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gJG07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3IE1lbWJlcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeaMh+WumuWQjeensOeahOeUqOaIt+aYr+WQpuWtmOWcqCjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tNZW1iZXJOYW1lRXhpc3QoJG5hbWUpDQogICAgew0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWUoJG5hbWUpOw0KDQogICAgICAgIHJldHVybiAkbS0+SUQgPiAwOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeaMh+WumuWQjeensOaIluWIq+WQjeeahOeUqOaIt+aYr+WQpuWtmOWcqCjkuI3ljLrliIblpKflsI/lhpkpLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tNZW1iZXJCeU5hbWVPckFsaWFzRXhpc3QoJG5hbWUpDQogICAgew0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeU5hbWVPckFsaWFzKCRuYW1lKTsNCg0KICAgICAgICByZXR1cm4gJG0tPklEID4gMDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4Dmn6XmjIflrprpgq7nrrHnmoTnlKjmiLfmmK/lkKblrZjlnKgo5LiN5Yy65YiG5aSn5bCP5YaZKS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkZW1haWwNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja01lbWJlckJ5RW1haWxFeGlzdCgkZW1haWwpDQogICAgew0KICAgICAgICAkbSA9ICR0aGlzLT5HZXRNZW1iZXJCeUVtYWlsKCRlbWFpbCk7DQoNCiAgICAgICAgcmV0dXJuICRtLT5JRCA+IDA7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HSUTojrflj5bor4Torrrlrp7kvosuDQogICAgICoNCiAgICAgKiBAcGFyYW0gaW50ICRpZA0KICAgICAqDQogICAgICogQHJldHVybiBDb21tZW50fEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q29tbWVudEJ5SUQoJGlkKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRTb21lVGhpbmcoJ2NvbW1lbnRzJywgJ0lEJywgJGlkLCAnQ29tbWVudCcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+W6ZmE5Lu25a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVXBsb2FkfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VXBsb2FkQnlJRCgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPkdldFNvbWVUaGluZygnJywgJ0lEJywgJGlkLCAnVXBsb2FkJyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HdGFn5ZCN6I635Y+WdGFn5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBudWxsICAgJGJhY2tLZXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlBbGlhcygkbmFtZSwgJGJhY2tLZXkgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgJHJldCA9ICR0aGlzLT5HZXRTb21lVGhpbmdCeUFsaWFzKCd0YWdzJywgJG5hbWUsICRiYWNrS2V5LCAnVGFnJyk7DQogICAgICAgIGlmICgkcmV0LT5JRCA+PSAwKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZVskcmV0LT5JRF0gPSAmJHRoaXMtPnRhZ3NbJHJldC0+SURdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+HdGFn5ZCN6I635Y+WdGFn5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqDQogICAgICogQHJldHVybiBUYWd8QmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUYWdCeUFsaWFzT3JOYW1lKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgLy9yZXR1cm4gJHRoaXMtPkdldFRhZ0J5QWxpYXMoJG5hbWUsICdOYW1lJyk7DQogICAgICAgICRhID0gYXJyYXkoKTsNCiAgICAgICAgJGFbXSA9IGFycmF5KCd0YWdfQWxpYXMnLCAkbmFtZSk7DQogICAgICAgICRhW10gPSBhcnJheSgndGFnX05hbWUnLCAkbmFtZSk7DQogICAgICAgICRhcnJheSA9ICR0aGlzLT5HZXRUYWdMaXN0KCcqJywgYXJyYXkoYXJyYXkoJ2FycmF5JywgJGEpKSwgJycsIDEsICcnKTsNCiAgICAgICAgaWYgKGNvdW50KCRhcnJheSkgPT0gMCkgew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBUYWcoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0aGlzLT50YWdzWyRhcnJheVswXS0+SURdID0gJGFycmF5WzBdOw0KICAgICAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVbJGFycmF5WzBdLT5JRF0gPSAmJHRoaXMtPnRhZ3NbJGFycmF5WzBdLT5JRF07DQoNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+dGFnc1skYXJyYXlbMF0tPklEXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmAmui/h0lE6I635Y+WdGFn5a6e5L6LLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gVGFnfEJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0VGFnQnlJRCgkaWQpDQogICAgew0KICAgICAgICAkcmV0ID0gJHRoaXMtPkdldFNvbWVUaGluZygndGFncycsICdJRCcsICRpZCwgJ1RhZycpOw0KICAgICAgICBpZiAoJHJldC0+SUQgPiAwKSB7DQogICAgICAgICAgICAkdGhpcy0+dGFnc2J5bmFtZVskcmV0LT5JRF0gPSAmJHRoaXMtPnRhZ3NbJHJldC0+SURdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H57G75Ly8J3sxfXsyfXszfXs0fSfovb3lhaV0YWdzLg0KICAgICAqDQogICAgICogQHBhcmFtICRzDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGFycmF5DQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRUYWdzQnlJRFN0cmluZygkcykNCiAgICB7DQogICAgICAgICRzID0gdHJpbSgkcyk7DQogICAgICAgIGlmICgkcyA9PT0gJycpIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJHMgPSBzdHJfcmVwbGFjZSgnfXsnLCAnfCcsICRzKTsNCiAgICAgICAgJHMgPSBzdHJfcmVwbGFjZSgneycsICcnLCAkcyk7DQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoJ30nLCAnJywgJHMpOw0KICAgICAgICAkYSA9IGV4cGxvZGUoJ3wnLCAkcyk7DQogICAgICAgICRiID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJGEgYXMgJiR2YWx1ZSkgew0KICAgICAgICAgICAgJHZhbHVlID0gdHJpbSgkdmFsdWUpOw0KICAgICAgICAgICAgaWYgKCR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICRiW10gPSAkdmFsdWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJHQgPSBhcnJheV91bmlxdWUoJGIpOw0KDQogICAgICAgIGlmIChjb3VudCgkdCkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGEgPSBhcnJheSgpOw0KICAgICAgICAkYiA9IGFycmF5KCk7DQogICAgICAgICRjID0gYXJyYXkoKTsNCiAgICAgICAgZm9yZWFjaCAoJHQgYXMgJHYpIHsNCiAgICAgICAgICAgIGlmICghaXNzZXQoJHRoaXMtPnRhZ3NbJHZdKSkgew0KICAgICAgICAgICAgICAgICRhW10gPSBhcnJheSgndGFnX0lEJywgJHYpOw0KICAgICAgICAgICAgICAgICRjW10gPSAkdjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJGJbJHZdID0gJiR0aGlzLT50YWdzWyR2XTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjb3VudCgkYSkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiAkYjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICR0ID0gYXJyYXkoKTsNCiAgICAgICAgICAgIC8vJGFycmF5PSR0aGlzLT5HZXRUYWdMaXN0KCcnLGFycmF5KGFycmF5KCdhcnJheScsJGEpKSwnJywnJywnJyk7DQogICAgICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnJywgYXJyYXkoYXJyYXkoJ0lOJywgJ3RhZ19JRCcsICRjKSksICcnLCAnJywgJycpOw0KICAgICAgICAgICAgZm9yZWFjaCAoJGFycmF5IGFzICR2KSB7DQogICAgICAgICAgICAgICAgJHRoaXMtPnRhZ3NbJHYtPklEXSA9ICR2Ow0KICAgICAgICAgICAgICAgICR0aGlzLT50YWdzYnluYW1lWyR2LT5OYW1lXSA9ICYkdGhpcy0+dGFnc1skdi0+SURdOw0KICAgICAgICAgICAgICAgICR0WyR2LT5JRF0gPSAmJHRoaXMtPnRhZ3NbJHYtPklEXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGFycmF5X21lcmdlKCRiLCAkdCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpgJrov4fnsbvkvLwnYWFhLGJiYixjY2MsZGRkJ+i9veWFpXRhZ3MuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRzIOagh+etvuWQjeWtl+espuS4su+8jOWmgidhYWEsYmJiLGNjYyxkZGQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYXJyYXkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gTG9hZFRhZ3NCeU5hbWVTdHJpbmcoJHMpDQogICAgew0KICAgICAgICAkcyA9IHRyaW0oJHMpOw0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKCc7JywgJywnLCAkcyk7DQogICAgICAgICRzID0gc3RyX3JlcGxhY2UoJ++8jCcsICcsJywgJHMpOw0KICAgICAgICAkcyA9IHN0cl9yZXBsYWNlKCfjgIEnLCAnLCcsICRzKTsNCiAgICAgICAgJHMgPSB0cmltKCRzKTsNCiAgICAgICAgJHMgPSBzdHJpcF90YWdzKCRzKTsNCiAgICAgICAgaWYgKCRzID09PSAnJyB8fCAkcyA9PT0gJywnKSB7DQogICAgICAgICAgICByZXR1cm4gYXJyYXkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICRhID0gZXhwbG9kZSgnLCcsICRzKTsNCiAgICAgICAgJHQgPSBhcnJheV91bmlxdWUoJGEpOw0KDQogICAgICAgIGlmIChjb3VudCgkdCkgPT09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBhcnJheSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgJGEgPSBhcnJheSgpOw0KICAgICAgICAkYiA9IGFycmF5KCk7DQogICAgICAgIGZvcmVhY2ggKCR0IGFzICR2YWx1ZSkgew0KICAgICAgICAgICAgJHYgPSB0cmltKCR2YWx1ZSk7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnRhZ3NieW5hbWVbJHZdKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICRhW10gPSBhcnJheSgndGFnX05hbWUnLCAkdik7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRiWyR2XSA9ICYkdGhpcy0+dGFnc2J5bmFtZVskdl07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY291bnQoJGEpID09PSAwKSB7DQogICAgICAgICAgICByZXR1cm4gJGI7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkdCA9IGFycmF5KCk7DQogICAgICAgICAgICAkYXJyYXkgPSAkdGhpcy0+R2V0VGFnTGlzdCgnJywgYXJyYXkoYXJyYXkoJ2FycmF5JywgJGEpKSwgJycsICcnLCAnJyk7DQogICAgICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJHYpIHsNCiAgICAgICAgICAgICAgICAkdGhpcy0+dGFnc1skdi0+SURdID0gJHY7DQogICAgICAgICAgICAgICAgJHRoaXMtPnRhZ3NieW5hbWVbJHYtPk5hbWVdID0gJiR0aGlzLT50YWdzWyR2LT5JRF07DQogICAgICAgICAgICAgICAgJHRbJHYtPk5hbWVdID0gJiR0aGlzLT50YWdzWyR2LT5JRF07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmb3JlYWNoICgkdCBhcyAka2V5ID0+ICR2YWx1ZSkgew0KICAgICAgICAgICAgICAgICRiWyRrZXldID0gJHZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuICRiOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YCa6L+H5pWw57uEYXJyYXlbMTExLDMzMyw0NDQsNTU1LDY2Nl3ovazmjaLmiJDlrZjlgqjkuLIuDQogICAgICoNCiAgICAgKiBAcGFyYW0gYXJyYXkgJGFycmF5IOagh+etvklE5pWw57uEDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb252ZXJ0VGFnSUR0b1N0cmluZygkYXJyYXkpDQogICAgew0KICAgICAgICAkcyA9ICcnOw0KICAgICAgICBmb3JlYWNoICgkYXJyYXkgYXMgJGEpIHsNCiAgICAgICAgICAgICRzIC49ICd7JyAuICRhIC4gJ30nOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWFqOmDqOe9rumhtuaWh+eroO+8iOS8mOWFiOS7jmNhY2hl6YeM6K+75pWw57uE77yJLg0KICAgICAqDQogICAgICogQHBhcmFtIGludCAkdHlwZQ0KICAgICAqDQogICAgICogQHJldHVybiBhcnJheQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUb3BBcnRpY2xlKCR0eXBlID0gMCkNCiAgICB7DQogICAgICAgICR2YXJuYW1lID0gJ3RvcF9wb3N0X2FycmF5XycgLiAkdHlwZTsNCiAgICAgICAgaWYgKCR0aGlzLT5jYWNoZS0+SGFzS2V5KCR2YXJuYW1lKSA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuIGFycmF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkgPSB1bnNlcmlhbGl6ZSgkdGhpcy0+Y2FjaGUtPiR2YXJuYW1lKTsNCiAgICAgICAgaWYgKCFpc19hcnJheSgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkpKSB7DQogICAgICAgICAgICBDb3VudFRvcEFydGljbGUoJHR5cGUsIG51bGwsIG51bGwpOw0KICAgICAgICAgICAgJGFydGljbGVzX3RvcF9ub3RvcmRlcl9pZGFycmF5ID0gdW5zZXJpYWxpemUoJHRoaXMtPmNhY2hlLT4kdmFybmFtZSk7DQogICAgICAgIH0NCiAgICAgICAgJGFydGljbGVzX3RvcF9ub3RvcmRlciA9ICR0aGlzLT5HZXRQb3N0QnlBcnJheSgkYXJ0aWNsZXNfdG9wX25vdG9yZGVyX2lkYXJyYXkpOw0KDQogICAgICAgIHJldHVybiAkYXJ0aWNsZXNfdG9wX25vdG9yZGVyOw0KICAgIH0NCg0KICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgLy/pqozor4Hnm7jlhbMNCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluivhOiuumtleS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldENtdEtleSgkaWQpDQogICAgew0KICAgICAgICByZXR1cm4gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDpqozor4Hor4TorrprZXkuDQogICAgICoNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICogQHBhcmFtICRrZXkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBWYWxpZENtdEtleSgkaWQsICRrZXkpDQogICAgew0KICAgICAgICAkbm93a2V5ID0gbWQ1KCR0aGlzLT5ndWlkIC4gJGlkIC4gZGF0ZSgnWW1kaCcpKTsNCiAgICAgICAgJG5vd2tleTIgPSBtZDUoJHRoaXMtPmd1aWQgLiAkaWQgLiBkYXRlKCdZbWRoJywgdGltZSgpIC0gKDM2MDAgKiAxKSkpOw0KDQogICAgICAgIHJldHVybiAka2V5ID09ICRub3drZXkgfHwgJGtleSA9PSAkbm93a2V5MjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5ZDU1JGIFRva2VuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQg5bqU55SoSUTvvIzlj6/ku6Xkv53or4Hmr4/kuKrlupTnlKjojrflj5bkuI3lkIznmoRUb2tlbg0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0Q1NSRlRva2VuKCRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJHMgPSAkdGhpcy0+dXNlci0+SUQgLiAkdGhpcy0+dXNlci0+UGFzc3dvcmQgLiAkdGhpcy0+dXNlci0+U3RhdHVzOw0KDQogICAgICAgIHJldHVybiBtZDUoJHRoaXMtPmd1aWQgLiAkcyAuICRpZCAuIGRhdGUoJ1ltZGgnKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+BQ1NSRiBUb2tlbi4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHRva2VuDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQgICAg5bqU55SoSUTvvIzlj6/kuLrmr4/kuKrlupTnlKjnlJ/miJDkuIDkuKrkuJPlsZ50b2tlbg0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZlcmlmeUNTUkZUb2tlbigkdG9rZW4sICRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJHVzZXJTdHJpbmcgPSAkdGhpcy0+dXNlci0+SUQgLiAkdGhpcy0+dXNlci0+UGFzc3dvcmQgLiAkdGhpcy0+dXNlci0+U3RhdHVzOw0KICAgICAgICAkdG9rZW5TdHJpbmcgPSAkdGhpcy0+Z3VpZCAuICR1c2VyU3RyaW5nIC4gJGlkOw0KDQogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8PSAkdGhpcy0+Y3NyZkV4cGlyYXRpb247ICRpKyspIHsNCiAgICAgICAgICAgIGlmICgkdG9rZW4gPT09IG1kNSgkdG9rZW5TdHJpbmcgLiBkYXRlKCdZbWRoJywgdGltZSgpIC0gKDM2MDAgKiAkaSkpKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaYvuekuumqjOivgeeggQ0KICAgICAqDQogICAgICogQGFwaSBGaWx0ZXJfUGx1Z2luX1picF9TaG93VmFsaWRDb2RlIOWmguivpeaOpeWPo+acquiiq+aMgui9veWImeaYvuekuum7mOiupOmqjOivgeWbvueJhw0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkaWQg5ZG95ZCN5LqL5Lu2DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2hvd1ZhbGlkQ29kZSgkaWQgPSAnJykNCiAgICB7DQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TaG93VmFsaWRDb2RlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICByZXR1cm4gJGZwbmFtZSgkaWQpOyAvLyoNCiAgICAgICAgfQ0KDQogICAgICAgICRfdmMgPSBuZXcgVmFsaWRhdGVDb2RlKCk7DQogICAgICAgICRfdmMtPkdldEltZygpOw0KICAgICAgICBzZXRjb29raWUoJ2NhcHRjaGFfJyAuIGNyYzMyKCR0aGlzLT5ndWlkIC4gJGlkKSwgbWQ1KCR0aGlzLT5ndWlkIC4gZGF0ZSgiWW1kaCIpIC4gJF92Yy0+R2V0Q29kZSgpKSwgbnVsbCwgJHRoaXMtPmNvb2tpZXNwYXRoKTsNCg0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmr5Tlr7npqozor4HnoIENCiAgICAgKg0KICAgICAqIEBhcGkgRmlsdGVyX1BsdWdpbl9aYnBfQ2hlY2tWYWxpZENvZGUg5aaC6K+l5o6l5Y+j5pyq6KKr5oyC6L295YiZ5q+U5a+56buY6K6k6aqM6K+B56CBDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR2ZXJpZnlDb2RlIOmqjOivgeeggeaVsOWAvA0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkICAgICAgICAg5ZG95ZCN5LqL5Lu2DQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gQ2hlY2tWYWxpZENvZGUoJHZlcmlmeUNvZGUsICRpZCA9ICcnKQ0KICAgIHsNCiAgICAgICAgJHZlcmlmeUNvZGUgPSBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKTsNCiAgICAgICAgZm9yZWFjaCAoJEdMT0JBTFNbJ2hvb2tzJ11bJ0ZpbHRlcl9QbHVnaW5fWmJwX0NoZWNrVmFsaWRDb2RlJ10gYXMgJGZwbmFtZSA9PiAmJGZwc2lnbmFsKSB7DQogICAgICAgICAgICByZXR1cm4gJGZwbmFtZSgkdmVyaWZ5Q29kZSwgJGlkKTsgLy8qDQogICAgICAgIH0NCg0KICAgICAgICAkb3JpZ2luYWwgPSBHZXRWYXJzKCdjYXB0Y2hhXycgLiBjcmMzMigkdGhpcy0+Z3VpZCAuICRpZCksICdDT09LSUUnKTsNCiAgICAgICAgc2V0Y29va2llKCdjYXB0Y2hhXycgLiBjcmMzMigkdGhpcy0+Z3VpZCAuICRpZCksICcnLCB0aW1lKCkgLSAzNjAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KDQogICAgICAgIHJldHVybiBtZDUoJHRoaXMtPmd1aWQgLiBkYXRlKCJZbWRoIikgLiBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKSkgPT0gJG9yaWdpbmFsDQogICAgICAgICAgICAgICAgfHwNCiAgICAgICAgICAgICAgICBtZDUoJHRoaXMtPmd1aWQgLiBkYXRlKCJZbWRoIiwgdGltZSgpIC0gKDM2MDAgKiAxKSkgLiBzdHJ0b2xvd2VyKCR2ZXJpZnlDb2RlKSkgPT0gJG9yaWdpbmFsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWQkeWvvOiIquiPnOWNlea3u+WKoOebuOW6lOadoeebri4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgJHR5cGU9Y2F0ZWdvcnksdGFnLHBhZ2UsaXRlbQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJGlkDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHVybA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBBZGRJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCwgJG5hbWUsICR1cmwpDQogICAgew0KICAgICAgICBpZiAoISR0eXBlKSB7DQogICAgICAgICAgICAkdHlwZSA9ICdpdGVtJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtID0gJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyduYXZiYXInXTsNCiAgICAgICAgJHMgPSAkbS0+Q29udGVudDsNCg0KICAgICAgICAkYSA9ICc8bGkgaWQ9Im5hdmJhci0nIC4gJHR5cGUgLiAnLScgLiAkaWQgLiAnIj48YSBocmVmPSInIC4gJHVybCAuICciPicgLiAkbmFtZSAuICc8L2E+PC9saT4nOw0KDQogICAgICAgIGlmICgkdGhpcy0+Q2hlY2tJdGVtVG9OYXZiYXIoJHR5cGUsICRpZCkpIHsNCiAgICAgICAgICAgICRzID0gcHJlZ19yZXBsYWNlKCcvPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+Lio/PFwvbGk+LycsICRhLCAkcyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkcyAuPSAnPGxpIGlkPSJuYXZiYXItJyAuICR0eXBlIC4gJy0nIC4gJGlkIC4gJyI+PGEgaHJlZj0iJyAuICR1cmwgLiAnIj4nIC4gJG5hbWUgLiAnPC9hPjwvbGk+JzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtLT5Db250ZW50ID0gJHM7DQogICAgICAgICRtLT5TYXZlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yig6Zmk5a+86Iiq6I+c5Y2V5Lit55u45bqU5p2h55uuLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZQ0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gRGVsSXRlbVRvTmF2YmFyKCR0eXBlLCAkaWQpDQogICAgew0KICAgICAgICBpZiAoISR0eXBlKSB7DQogICAgICAgICAgICAkdHlwZSA9ICdpdGVtJzsNCiAgICAgICAgfQ0KDQogICAgICAgICRtID0gJHRoaXMtPm1vZHVsZXNieWZpbGVuYW1lWyduYXZiYXInXTsNCiAgICAgICAgJHMgPSAkbS0+Q29udGVudDsNCg0KICAgICAgICAkcyA9IHByZWdfcmVwbGFjZSgnLzxsaSBpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciPi4qPzxcL2xpPi8nLCAnJywgJHMpOw0KDQogICAgICAgICRtLT5Db250ZW50ID0gJHM7DQogICAgICAgICRtLT5TYXZlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5p+l5p2h55uu5piv5ZCm5Zyo5a+86Iiq6I+c5Y2V5LitLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkdHlwZQ0KICAgICAqIEBwYXJhbSAkaWQNCiAgICAgKg0KICAgICAqIEByZXR1cm4gYm9vbA0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja0l0ZW1Ub05hdmJhcigkdHlwZSwgJGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCEkdHlwZSkgew0KICAgICAgICAgICAgJHR5cGUgPSAnaXRlbSc7DQogICAgICAgIH0NCg0KICAgICAgICAkbSA9ICR0aGlzLT5tb2R1bGVzYnlmaWxlbmFtZVsnbmF2YmFyJ107DQogICAgICAgICRzID0gJG0tPkNvbnRlbnQ7DQoNCiAgICAgICAgcmV0dXJuIChib29sKSBzdHJwb3MoJHMsICdpZD0ibmF2YmFyLScgLiAkdHlwZSAuICctJyAuICRpZCAuICciJyk7DQogICAgfQ0KDQogICAgLy8kc2lnbmFsID0gZ29vZCxiYWQsdGlwcw0KICAgIHByaXZhdGUgJGhpbnQxID0gbnVsbDsNCiAgICBwcml2YXRlICRoaW50MiA9IG51bGw7DQogICAgcHJpdmF0ZSAkaGludDMgPSBudWxsOw0KICAgIHByaXZhdGUgJGhpbnQ0ID0gbnVsbDsNCiAgICBwcml2YXRlICRoaW50NSA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7mj5DnpLrmtojmga/lubblrZjlhaVDb29raWUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYWwgIOaPkOekuuexu+Wei++8iGdvb2R8YmFkfHRpcHPvvIkNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRjb250ZW50IOaPkOekuuWGheWuuQ0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBTZXRIaW50KCRzaWduYWwsICRjb250ZW50ID0gJycpDQogICAgew0KICAgICAgICBpZiAoJGNvbnRlbnQgPT0gJycpIHsNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgNCkgPT0gJ2dvb2QnKSB7DQogICAgICAgICAgICAgICAgJGNvbnRlbnQgPSAkdGhpcy0+bGFuZ1snbXNnJ11bJ29wZXJhdGlvbl9zdWNjZWVkJ107DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChzdWJzdHIoJHNpZ25hbCwgMCwgMykgPT0gJ2JhZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX2ZhaWxlZCddOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICRjb250ZW50ID0gc3Vic3RyKCRjb250ZW50LCAwLCAyNTUpOw0KICAgICAgICBpZiAoJHRoaXMtPmhpbnQxID09IG51bGwpIHsNCiAgICAgICAgICAgICR0aGlzLT5oaW50MSA9ICRzaWduYWwgLiAnfCcgLiAkY29udGVudDsNCiAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwxIiwgJHNpZ25hbCAuICd8JyAuICRjb250ZW50LCAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPmhpbnQyID09IG51bGwpIHsNCiAgICAgICAgICAgICR0aGlzLT5oaW50MiA9ICRzaWduYWwgLiAnfCcgLiAkY29udGVudDsNCiAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwyIiwgJHNpZ25hbCAuICd8JyAuICRjb250ZW50LCAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPmhpbnQzID09IG51bGwpIHsNCiAgICAgICAgICAgICR0aGlzLT5oaW50MyA9ICRzaWduYWwgLiAnfCcgLiAkY29udGVudDsNCiAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwzIiwgJHNpZ25hbCAuICd8JyAuICRjb250ZW50LCAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPmhpbnQ0ID09IG51bGwpIHsNCiAgICAgICAgICAgICR0aGlzLT5oaW50NCA9ICRzaWduYWwgLiAnfCcgLiAkY29udGVudDsNCiAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWw0IiwgJHNpZ25hbCAuICd8JyAuICRjb250ZW50LCAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICB9IGVsc2VpZiAoJHRoaXMtPmhpbnQ1ID09IG51bGwpIHsNCiAgICAgICAgICAgICR0aGlzLT5oaW50NSA9ICRzaWduYWwgLiAnfCcgLiAkY29udGVudDsNCiAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWw1IiwgJHNpZ25hbCAuICd8JyAuICRjb250ZW50LCAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5o+Q5Y+WQ29va2ll5Lit55qE5o+Q56S65raI5oGvLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRIaW50KCkNCiAgICB7DQogICAgICAgIGZvciAoJGkgPSAxOyAkaSA8PSA1OyAkaSsrKSB7DQogICAgICAgICAgICAkc2lnbmFsID0gJ2hpbnQnIC4gJGk7DQogICAgICAgICAgICAkc2lnbmFsID0gJHRoaXMtPiRzaWduYWw7DQogICAgICAgICAgICBpZiAoJHNpZ25hbCkgew0KICAgICAgICAgICAgICAgICRhID0gZXhwbG9kZSgnfCcsICRzaWduYWwpOw0KICAgICAgICAgICAgICAgICR0aGlzLT5TaG93SGludCgkYVswXSwgJGFbMV0pOw0KICAgICAgICAgICAgICAgIHNldGNvb2tpZSgiaGludF9zaWduYWwiIC4gJGksICcnLCB0aW1lKCkgLSAzNjAwLCAkdGhpcy0+Y29va2llc3BhdGgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZvciAoJGkgPSAxOyAkaSA8PSA1OyAkaSsrKSB7DQogICAgICAgICAgICAkc2lnbmFsID0gR2V0VmFycygnaGludF9zaWduYWwnIC4gJGksICdDT09LSUUnKTsNCiAgICAgICAgICAgIGlmICgkc2lnbmFsKSB7DQogICAgICAgICAgICAgICAgJGEgPSBleHBsb2RlKCd8JywgJHNpZ25hbCk7DQogICAgICAgICAgICAgICAgJHRoaXMtPlNob3dIaW50KCRhWzBdLCAkYVsxXSk7DQogICAgICAgICAgICAgICAgc2V0Y29va2llKCJoaW50X3NpZ25hbCIgLiAkaSwgJycsIHRpbWUoKSAtIDM2MDAsICR0aGlzLT5jb29raWVzcGF0aCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnlLHmj5DnpLrmtojmga/ojrflj5ZIVE1MLg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkc2lnbmFsICDmj5DnpLrnsbvlnovvvIhnb29kfGJhZHx0aXBz77yJDQogICAgICogQHBhcmFtIHN0cmluZyAkY29udGVudCDmj5DnpLrlhoXlrrkNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU2hvd0hpbnQoJHNpZ25hbCwgJGNvbnRlbnQgPSAnJykNCiAgICB7DQogICAgICAgIGlmICgkY29udGVudCA9PSAnJykgew0KICAgICAgICAgICAgaWYgKHN1YnN0cigkc2lnbmFsLCAwLCA0KSA9PSAnZ29vZCcpIHsNCiAgICAgICAgICAgICAgICAkY29udGVudCA9ICR0aGlzLT5sYW5nWydtc2cnXVsnb3BlcmF0aW9uX3N1Y2NlZWQnXTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKHN1YnN0cigkc2lnbmFsLCAwLCAzKSA9PSAnYmFkJykgew0KICAgICAgICAgICAgICAgICRjb250ZW50ID0gJHRoaXMtPmxhbmdbJ21zZyddWydvcGVyYXRpb25fZmFpbGVkJ107DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZWNobyAiPGRpdiBjbGFzcz1cImhpbnRcIj48cCBjbGFzcz1cImhpbnQgaGludF8kc2lnbmFsXCI+JGNvbnRlbnQ8L3A+PC9kaXY+IjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmL7npLrplJnor6/kv6Hmga8uDQogICAgICoNCiAgICAgKiBAYXBpIEZpbHRlcl9QbHVnaW5fWmJwX1Nob3dFcnJvcg0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZy9pbnQgJGVycm9yVGV4dA0KICAgICAqIEBwYXJhbSBudWxsICAgICAgICRmaWxlDQogICAgICogQHBhcmFtIG51bGwgICAgICAgJGxpbmUNCiAgICAgKg0KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNob3dFcnJvcigkZXJyb3JUZXh0LCAkZmlsZSA9IG51bGwsICRsaW5lID0gbnVsbCkNCiAgICB7DQogICAgICAgICRlcnJvckNvZGUgPSAwOw0KICAgICAgICBpZiAoaXNfbnVtZXJpYygkZXJyb3JUZXh0KSkgew0KICAgICAgICAgICAgJGVycm9yQ29kZSA9IChpbnQpICRlcnJvclRleHQ7DQogICAgICAgICAgICAkZXJyb3JUZXh0ID0gJHRoaXMtPmxhbmdbJ2Vycm9yJ11bJGVycm9yVGV4dF07DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoJGVycm9yQ29kZSA9PSAyKSB7DQogICAgICAgICAgICBIdHRwNDA0KCk7DQogICAgICAgIH0NCg0KICAgICAgICBaQmxvZ0V4Y2VwdGlvbjo6JGVycm9yX2lkID0gJGVycm9yQ29kZTsNCiAgICAgICAgWkJsb2dFeGNlcHRpb246OiRlcnJvcl9maWxlID0gJGZpbGU7DQogICAgICAgIFpCbG9nRXhjZXB0aW9uOjokZXJyb3JfbGluZSA9ICRsaW5lOw0KDQogICAgICAgIGlmIChzdHJpcG9zKCd7JyAuIHNoYTEoJ211c3RzaG93ZXJyb3InKSAuICd9JywgJGVycm9yVGV4dCkgPT09IDApIHsNCiAgICAgICAgICAgICRlcnJvclRleHQgPSBzdHJfcmVwbGFjZSgneycgLiBzaGExKCdtdXN0c2hvd2Vycm9yJykgLiAnfScsICcnLCAkZXJyb3JUZXh0KTsNCiAgICAgICAgICAgICRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX0RlYnVnX0Rpc3BsYXknXSA9IGFycmF5KCk7DQogICAgICAgICAgICAkR0xPQkFMU1snaG9va3MnXVsnRmlsdGVyX1BsdWdpbl9EZWJ1Z19IYW5kbGVyJ10gPSBhcnJheSgpOw0KDQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCRlcnJvclRleHQpOw0KICAgICAgICAgICAgZXhpdCgxKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZvcmVhY2ggKCRHTE9CQUxTWydob29rcyddWydGaWx0ZXJfUGx1Z2luX1picF9TaG93RXJyb3InXSBhcyAkZnBuYW1lID0+ICYkZnBzaWduYWwpIHsNCiAgICAgICAgICAgICRmcHJldHVybiA9ICRmcG5hbWUoJGVycm9yQ29kZSwgJGVycm9yVGV4dCwgJGZpbGUsICRsaW5lKTsNCiAgICAgICAgICAgIGlmICgkZnBzaWduYWwgPT0gUExVR0lOX0VYSVRTSUdOQUxfUkVUVVJOKSB7DQogICAgICAgICAgICAgICAgJGZwc2lnbmFsID0gUExVR0lOX0VYSVRTSUdOQUxfTk9ORTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZnByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCRlcnJvclRleHQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOajgOafpeW5tuW8gOWQr0d6aXDljovnvKkuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIENoZWNrR3ppcCgpDQogICAgew0KICAgICAgICBpZiAoZXh0ZW5zaW9uX2xvYWRlZCgiemxpYiIpICYmDQogICAgICAgICAgICBpc3NldCgkX1NFUlZFUlsiSFRUUF9BQ0NFUFRfRU5DT0RJTkciXSkgJiYNCiAgICAgICAgICAgIHN0cnN0cigkX1NFUlZFUlsiSFRUUF9BQ0NFUFRfRU5DT0RJTkciXSwgImd6aXAiKQ0KICAgICAgICApIHsNCiAgICAgICAgICAgICR0aGlzLT5pc0d6aXAgPSB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5ZCv55SoR3ppcC4NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gU3RhcnRHemlwKCkNCiAgICB7DQogICAgICAgIGlmICghaGVhZGVyc19zZW50KCkgJiYgJHRoaXMtPmlzR3ppcCAmJiAkdGhpcy0+b3B0aW9uWydaQ19HWklQX0VOQUJMRSddKSB7DQogICAgICAgICAgICBpZiAoaW5pX2dldCgnb3V0cHV0X2hhbmRsZXInKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJGEgPSBvYl9saXN0X2hhbmRsZXJzKCk7DQogICAgICAgICAgICBpZiAoaW5fYXJyYXkoJ29iX2d6aGFuZGxlcicsICRhKSB8fCBpbl9hcnJheSgnemxpYiBvdXRwdXQgY29tcHJlc3Npb24nLCAkYSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ2luaV9zZXQnKSAmJiBmdW5jdGlvbl9leGlzdHMoJ3psaWJfZW5jb2RlJykpIHsNCiAgICAgICAgICAgICAgICBAb2JfZW5kX2NsZWFuKCk7DQogICAgICAgICAgICAgICAgQGluaV9zZXQoJ3psaWIub3V0cHV0X2NvbXByZXNzaW9uJywgJ09uJyk7DQogICAgICAgICAgICAgICAgQGluaV9zZXQoJ3psaWIub3V0cHV0X2NvbXByZXNzaW9uX2xldmVsJywgJzUnKTsNCiAgICAgICAgICAgIH0gZWxzZWlmIChmdW5jdGlvbl9leGlzdHMoJ29iX2d6aGFuZGxlcicpKSB7DQogICAgICAgICAgICAgICAgQG9iX2VuZF9jbGVhbigpOw0KICAgICAgICAgICAgICAgIEBvYl9zdGFydCgnb2JfZ3poYW5kbGVyJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBvYl9zdGFydCgpOw0KDQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmo4DmtYvnvZHnq5nlhbPpl63vvIzlpoLmnpzlhbPpl63vvIzliJnmipvlh7rplJnor68uDQogICAgICoNCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBDaGVja1NpdGVDbG9zZWQoKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX0NMT1NFX1NJVEUnXSkgew0KICAgICAgICAgICAgSHR0cDUwMygpOw0KICAgICAgICAgICAgJHRoaXMtPlNob3dFcnJvcig4MiwgX19GSUxFX18sIF9fTElORV9fKTsNCiAgICAgICAgICAgIGV4aXQ7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDot7PovazliLDlronoo4XpobXpnaIuDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFJlZGlyZWN0SW5zdGFsbCgpDQogICAgew0KICAgICAgICBpZiAoISR0aGlzLT5vcHRpb25bJ1pDX0RBVEFCQVNFX1RZUEUnXSkgew0KICAgICAgICAgICAgUmVkaXJlY3QoJy4vemJfaW5zdGFsbC9pbmRleC5waHAnKTsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgLyoqDQogICAgICog5qOA5rWL5b2T5YmNdXJs77yM5aaC5p6c5LiN56ym5ZCI6K6+572u5bCx6Lez6L2s5Yiw5Zu65a6a5Z+f5ZCN55qE6ZO+5o6lLg0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBSZWRpcmVjdFBlcm1hbmVudERvbWFpbigpDQogICAgew0KICAgICAgICAkZG9tYWluX2Rpc2FibGUgPSBHZXRWYWx1ZUluQXJyYXkoJHRoaXMtPm9wdGlvbiwnWkNfUEVSTUFORU5UX0RPTUFJTl9XSE9MRV9ESVNBQkxFJyk7DQogICAgICAgIGlmICgkZG9tYWluX2Rpc2FibGUgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgJGZvcmNlZCA9IEdldFZhbHVlSW5BcnJheSgkdGhpcy0+b3B0aW9uLCdaQ19QRVJNQU5FTlRfRE9NQUlOX0ZPUkNFRF9VUkwnKTsNCiAgICAgICAgaWYgKCR0aGlzLT5vcHRpb25bJ1pDX1BFUk1BTkVOVF9ET01BSU5fRU5BQkxFJ10gPT0gZmFsc2UgJiYgJGZvcmNlZCA9PSAnJykgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgJGhvc3QgPSBzdHJfcmVwbGFjZShhcnJheSgnaHR0cHM6Ly8nLCAnaHR0cDovLycpLCBhcnJheSgnJywgJycpLCBHZXRDdXJyZW50SG9zdChaQlBfUEFUSCwgJG51bGwpKTsNCiAgICAgICAgJGhvc3QyID0gc3RyX3JlcGxhY2UoYXJyYXkoJ2h0dHBzOi8vJywgJ2h0dHA6Ly8nKSwgYXJyYXkoJycsICcnKSwgJHRoaXMtPmhvc3QpOw0KDQogICAgICAgIGlmICgkaG9zdCAhPSAkaG9zdDIpIHsNCiAgICAgICAgICAgICR1ID0gR2V0UmVxdWVzdFVyaSgpOw0KICAgICAgICAgICAgJHUgPSAkdGhpcy0+aG9zdCAuIHN1YnN0cigkdSwgMSwgc3RybGVuKCR1KSk7DQogICAgICAgICAgICBSZWRpcmVjdDMwMSgkdSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDms6jlhoxQb3N0VHlwZS4NCiAgICAgKg0KICAgICAqIEBwYXJhbSAkdHlwZUlkDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtIHN0cmluZyAkdXJsUnVsZSAgICAgIOm7mOiupOaYr+WPllBhZ2XnsbvlnovnmoRVcmwgUnVsZQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHRlbXBsYXRlICAgICDpu5jorqTmqKHmnb/lkI1wYWdlDQogICAgICogQHBhcmFtIHN0cmluZyAkY2F0ZWdvcnlUeXBlIOW9k+WJjeaWh+eroOexu+eahOWIhuexu1R5cGUNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR0YWdUeXBlICAgICAg5b2T5YmN5paH56ug57G755qE5qCH562+VHlwZQ0KICAgICAqDQogICAgICogQHRocm93cyBFeGNlcHRpb24NCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVnUG9zdFR5cGUoJHR5cGVJZCwgJG5hbWUsICR1cmxSdWxlID0gJycsICR0ZW1wbGF0ZSA9ICdzaW5nbGUnLCAkY2F0ZWdvcnlUeXBlID0gbnVsbCwgJHRhZ1R5cGUgPSBudWxsKQ0KICAgIHsNCiAgICAgICAgaWYgKCR1cmxSdWxlID09ICcnKSB7DQogICAgICAgICAgICAkdXJsUnVsZSA9ICR0aGlzLT5vcHRpb25bJ1pDX1BBR0VfUkVHRVgnXTsNCiAgICAgICAgfQ0KDQogICAgICAgICR0eXBlSWQgPSAoaW50KSAkdHlwZUlkOw0KICAgICAgICAkbmFtZSA9IHN0cnRvbG93ZXIodHJpbSgkbmFtZSkpOw0KICAgICAgICBpZiAoJHR5cGVJZCA+IDk5KSB7DQogICAgICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdKSkgew0KICAgICAgICAgICAgICAgICR0aGlzLT5TaG93RXJyb3IoODcsIF9fRklMRV9fLCBfX0xJTkVfXyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgJHRoaXMtPnBvc3R0eXBlWyR0eXBlSWRdID0gYXJyYXkoJG5hbWUsICR1cmxSdWxlLCAkdGVtcGxhdGUsICRjYXRlZ29yeVR5cGUsICR0YWdUeXBlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0gJHR5cGVpZA0KICAgICAqDQogICAgICogQHJldHVybiBzdHJpbmcNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfTmFtZSgkdHlwZWlkKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wb3N0dHlwZVskdHlwZWlkXSkpIHsNCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF1bMF07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJyc7DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX1VybFJ1bGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWzFdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICR0aGlzLT5vcHRpb25bJ1pDX1BBR0VfUkVHRVgnXTsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gR2V0UG9zdFR5cGVfVGVtcGxhdGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWzJdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICdzaW5nbGUnOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRQb3N0VHlwZV9DYXRlZ29yeVR5cGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWzNdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFBvc3RUeXBlX1RhZ1R5cGUoJHR5cGVpZCkNCiAgICB7DQogICAgICAgIGlmIChpc3NldCgkdGhpcy0+cG9zdHR5cGVbJHR5cGVpZF0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnBvc3R0eXBlWyR0eXBlaWRdWzRdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5rOo5YaMQWN0aW9uLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICogQHBhcmFtICRsZXZlbA0KICAgICAqIEBwYXJhbSAkdGl0bGUNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gUmVnQWN0aW9uKCRuYW1lLCAkbGV2ZWwsICR0aXRsZSkNCiAgICB7DQogICAgICAgICR0aGlzLT5hY3Rpb25zWyRuYW1lXSA9ICRsZXZlbDsNCiAgICAgICAgJHRoaXMtPmxhbmdbJ2FjdGlvbnMnXVskbmFtZV0gPSAkdGl0bGU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635b6XQWN0aW9u5p2D6ZmQ5rOo6YeKLg0KICAgICAqDQogICAgICogQHBhcmFtICRuYW1lDQogICAgICoNCiAgICAgKiBAcmV0dXJuIG1peGVkDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldEFjdGlvbkRlc2NyaXB0aW9uKCRuYW1lKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5sYW5nWydhY3Rpb25zJ11bJG5hbWVdKSkgew0KICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5sYW5nWydhY3Rpb25zJ11bJG5hbWVdOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICRuYW1lOw0KICAgIH0NCg0KICAgIC8v5Li+5L6L77yaYmFja2VuZC11aSwsLA0KICAgIHByb3RlY3RlZCAkX2V4Y2x1c2l2ZSA9IGFycmF5KCk7DQogICAgLyoqDQogICAgICog6YCa55+l57O757uf5o6n5Yi25p2DDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFNldEV4Y2x1c2l2ZSgkZnVuY3Rpb24sJGFwcGlkKQ0KICAgIHsNCiAgICAgICAgaWYgKCRhcHBpZCA9PSBmYWxzZSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgICR0aGlzLT5fZXhjbHVzaXZlWyRmdW5jdGlvbl0gPSAkYXBwaWQ7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICAvKioNCiAgICAgKiDmn6Xor6Lns7vnu5/mjqfliLbmnYMNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gSXNFeGNsdXNpdmUoJGZ1bmN0aW9uKQ0KICAgIHsNCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5fZXhjbHVzaXZlWyRmdW5jdGlvbl0pKSB7DQogICAgICAgICAgICByZXR1cm4gJHRoaXMtPl9leGNsdXNpdmVbJGZ1bmN0aW9uXTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Lul5LiL6YOo5YiG5Li65bey5bqf5byD77yM5L2G6ICD6JmR5Yiw5YW85a655oCn5L+d55WZ55qE5Luj56CBKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiouDQogICAgICovDQoNCiAgICAvKioNCiAgICAgKiDpqozor4HnlKjmiLfnmbvlvZXvvIhNRDXliqB6YnAtPmd1aWTnm5DlkI7nmoTlr4bnoIHvvIkuDQogICAgICoNCiAgICAgKiBAZGVwcmVjYXRlZA0KICAgICAqDQogICAgICogQHBhcmFtIHN0cmluZyAkbmFtZSAgICAgICAgIOeUqOaIt+WQjQ0KICAgICAqIEBwYXJhbSBzdHJpbmcgJHBzX3BhdGhfaGFzaCBNRDXliqB6YnAtPmd1aWTnm5DlkI7nmoTlr4bnoIENCiAgICAgKiBAcGFyYW0gb2JqZWN0ICRtZW1iZXIgICAgICAg6L+U5Zue6K+75Y+W5oiQ5Yqf55qEbWVtYmVy5a+56LGhDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmVyaWZ5X01ENVBhdGgoJG5hbWUsICRwc19wYXRoX2hhc2gsICYkbWVtYmVyID0gbnVsbCkNCiAgICB7DQogICAgICAgIGlmICgkbmFtZSA9PSAnJyB8fCAkcHNfcGF0aF9oYXNoID09ICcnKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgJG0gPSAkdGhpcy0+R2V0TWVtYmVyQnlOYW1lKCRuYW1lKTsNCiAgICAgICAgaWYgKCRtLT5JRCA+IDApIHsNCiAgICAgICAgICAgIGlmICgkbS0+UGFzc1dvcmRfTUQ1UGF0aCA9PSAkcHNfcGF0aF9oYXNoKSB7DQogICAgICAgICAgICAgICAgJG1lbWJlciA9ICRtOw0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6I635Y+WQ1NSRiBUb2tlbueahOmUmeivr+WIq+WQjS4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIFVzZSBgYEdldENTUkZUb2tlbmBgDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICRpZCDlupTnlKhJRO+8jOWPr+S7peS/neivgeavj+S4quW6lOeUqOiOt+WPluS4jeWQjOeahFRva2VuDQogICAgICoNCiAgICAgKiBAcmV0dXJuIHN0cmluZw0KICAgICAqLw0KICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRUb2tlbigkaWQgPSAnJykNCiAgICB7DQogICAgICAgIHJldHVybiAkdGhpcy0+R2V0Q1NSRlRva2VuKCRpZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6aqM6K+BQ1NSRiBUb2tlbueahOmUmeivr+WIq+WQjS4NCiAgICAgKg0KICAgICAqIEBkZXByZWNhdGVkIFVzZSBgYFZlcmlmeUNTUkZUb2tlbmBgDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHQNCiAgICAgKiBAcGFyYW0gJGlkDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGJvb2wNCiAgICAgKi8NCiAgICBwdWJsaWMgZnVuY3Rpb24gVmFsaWRUb2tlbigkdCwgJGlkID0gJycpDQogICAgew0KICAgICAgICByZXR1cm4gJHRoaXMtPlZlcmlmeUNTUkZUb2tlbigkdCwgJGlkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBAZGVwcmVjYXRlZA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIExvYWRDYXRlZ29yeXMoKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5Mb2FkQ2F0ZWdvcmllcygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluS8muivnVdlYlRva2VuLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQg5q+r5peg5oSP5LmJ77yM5Y2z5bCG5bqf5byDDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3RyaW5nICR3dF9pZA0KICAgICAqIEBwYXJhbSBpbnQgICAgJGRheSAgIOm7mOiupDHlpKnmnInmlYjmnJ/vvIwx5bCP5pe25Li6MS8yNO+8jDHliIbpkp/kuLoxLygyNCo2MCkNCiAgICAgKg0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIEdldFdlYlRva2VuKCR3dF9pZCA9ICcnLCAkZGF5ID0gMSkNCiAgICB7DQogICAgICAgICR0ID0gaW50dmFsKCRkYXkgKiAyNCAqIDM2MDApICsgdGltZSgpOw0KDQogICAgICAgIHJldHVybiBDcmVhdGVXZWJUb2tlbigkd3RfaWQsICR0LCAkdGhpcy0+Z3VpZCwgJHRoaXMtPnVzZXItPlN0YXR1cywgJHRoaXMtPnVzZXItPklELCAkdGhpcy0+dXNlci0+UGFzc3dvcmQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmqjOivgeS8muivnVdlYlRva2VuLg0KICAgICAqDQogICAgICogQGRlcHJlY2F0ZWQg5q+r5peg5oSP5LmJ77yM5Y2z5bCG5bqf5byDDQogICAgICoNCiAgICAgKiBAcGFyYW0gJHd0DQogICAgICogQHBhcmFtICR3dF9pZA0KICAgICAqDQogICAgICogQHJldHVybiBib29sDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIFZhbGlkV2ViVG9rZW4oJHd0LCAkd3RfaWQgPSAnJykNCiAgICB7DQogICAgICAgIGlmIChWZXJpZnlXZWJUb2tlbigkd3QsICR3dF9pZCwgJHRoaXMtPmd1aWQsICR0aGlzLT51c2VyLT5TdGF0dXMsICR0aGlzLT51c2VyLT5JRCwgJHRoaXMtPnVzZXItPlBhc3N3b3JkKSA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KfQ0K</file>
	<file name='zb_system\function\c_system_version.php' crc32='113FEA1E'  dt:dt='bin.base64'>PD9waHANCg0KaWYgKCFkZWZpbmVkKCdaQlBfUEFUSCcpKSB7DQogICAgZXhpdCgnQWNjZXNzIGRlbmllZCcpOw0KfQ0KLyoNCiAqIOWumuS5ieeJiOacrOWPtw0KDQrov5nmmK8xLjXlj5bmtojnmoTmlbDnu4TvvIzooqvlronmjpLliLDlupTnlKjkuK3lv4PlrqLmiLfnq6/nmoRpbmNsdWRlLnBocOaWh+S7tumHjOOAgg0KI+WumuS5ieeJiOacrOWPt+WIlw0KJHpicHZlcnM9YXJyYXkoKTsNCiR6YnB2ZXJzWycxMzA3MDcnXT0nMS4wIEJldGEgQnVpbGQgMTMwNzA3JzsNCiR6YnB2ZXJzWycxMzExMTEnXT0nMS4wIEJldGEyIEJ1aWxkIDEzMTExMSc7DQokemJwdmVyc1snMTMxMjIxJ109JzEuMSBUYWljaGkgQnVpbGQgMTMxMjIxJzsNCiR6YnB2ZXJzWycxNDAyMjAnXT0nMS4yIEhpcHBvIEJ1aWxkIDE0MDIyMCc7DQokemJwdmVyc1snMTQwNjE0J109JzEuMyBXb25jZSBCdWlsZCAxNDA2MTQnOw0KJHpicHZlcnNbJzE1MDEwMSddPScxLjQgRGVlcGx1ZSBCdWlsZCAxNTAxMDEnOw0KJHpicHZlcnNbJzE1MTYyNiddPScxLjUgWmVybyBCdWlsZCAxNTE2MjYnOw0KDQogKi8NCmRlZmluZSgnWkNfVkVSU0lPTl9NQUpPUicsICcxJyk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fTUlOT1InLCAnNicpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0JVSUxEJywgJzYnKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9DT01NSVQnLCAnMjE1MCcpOw0KZGVmaW5lKCdaQ19WRVJTSU9OX0NPREVOQU1FJywgJ1ZhbHlyaWEnKTsNCmRlZmluZSgnWkNfVkVSU0lPTicsIFpDX1ZFUlNJT05fTUFKT1IgLiAnLicgLiBaQ19WRVJTSU9OX01JTk9SIC4gJy4nIC4gWkNfVkVSU0lPTl9CVUlMRCAuICcuJyAuIFpDX1ZFUlNJT05fQ09NTUlUKTsNCmRlZmluZSgnWkNfVkVSU0lPTl9ESVNQTEFZJywgWkNfVkVSU0lPTl9NQUpPUiAuICcuJyAuIFpDX1ZFUlNJT05fTUlOT1IgLiAnLicgLiBaQ19WRVJTSU9OX0JVSUxEIC4gJyAnIC4gWkNfVkVSU0lPTl9DT0RFTkFNRSk7DQpkZWZpbmUoJ1pDX1ZFUlNJT05fRlVMTCcsIFpDX1ZFUlNJT04gLiAnICgnIC4gWkNfVkVSU0lPTl9DT0RFTkFNRSAuICcpJyk7DQpkZWZpbmUoJ1pDX0JMT0dfQ09NTUlUJywgWkNfVkVSU0lPTl9DT01NSVQpOyAvLyDkuLrlhpnlhaXns7vnu5/phY3nva7nu5/kuIDpo47moLwNCiRHTE9CQUxTWydibG9ndmVyc2lvbiddID0gWkNfVkVSU0lPTl9NQUpPUiAuIFpDX1ZFUlNJT05fTUlOT1IgLiBaQ19WRVJTSU9OX0NPTU1JVDsNCmRlZmluZSgnWkNfQkxPR19WRVJTSU9OJywgWkNfVkVSU0lPTl9ESVNQTEFZIC4gJyBCdWlsZCAnIC4gJEdMT0JBTFNbJ2Jsb2d2ZXJzaW9uJ10pOw0K</file>
</files>